# Express Application Generator ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

> Express ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é››å½¢ã‚’ç´ æ—©ãä½œæˆã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™

## ç›®æ¬¡

1. [ã¯ã˜ã‚ã«](#ã¯ã˜ã‚ã«)
2. [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•](#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•)
3. [åŸºæœ¬çš„ãªä½¿ã„æ–¹](#åŸºæœ¬çš„ãªä½¿ã„æ–¹)
4. [ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³](#ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
5. [ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³](#ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³)
6. [Pugã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª](#pugã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª)
7. [EJSã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª](#ejsã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª)
8. [Handlebarsã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª](#handlebarsã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª)
9. [Hoganã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª](#hoganã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª)
10. [ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®æ¯”è¼ƒ](#ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®æ¯”è¼ƒ)
11. [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)

## ã¯ã˜ã‚ã«

Express Application Generatorã¯ã€Expressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºæœ¬æ§‹é€ ã‚’ç´ æ—©ãä½œæˆã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é››å½¢ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€é–‹ç™ºã®åˆæœŸæ®µéšã‚’å¤§å¹…ã«çŸ­ç¸®ã§ãã¾ã™ã€‚

### ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§å­¦ã¹ã‚‹ã“ã¨

- Express Generatorã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åŸºæœ¬çš„ãªä½¿ã„æ–¹
- æ§˜ã€…ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ç‰¹å¾´ã¨ä½¿ã„åˆ†ã‘
- Pugã€EJSã€Handlebarsã€Hoganã‚’ä½¿ã£ãŸå®Ÿè·µçš„ãªã‚µãƒ³ãƒ—ãƒ«
- ç”Ÿæˆã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹é€ ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

Express Generatorã¯ã€Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚‹æ–¹æ³•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

### Node.js 8.2.0ä»¥é™ã®å ´åˆ

npxã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã›ãšã«ç›´æ¥å®Ÿè¡Œã§ãã¾ã™ï¼š

```bash
npx express-generator
```

### å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Node.jsã®å ´åˆ

npmã‚’ä½¿ã£ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š

```bash
npm install -g express-generator
```

> **ğŸ’¡ ãƒ’ãƒ³ãƒˆ**: npxã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¸¸ã«æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®generatorã‚’ä½¿ç”¨ã§ãã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªç’°å¢ƒã‚’æ±šæŸ“ã—ã¾ã›ã‚“ã€‚

## åŸºæœ¬çš„ãªä½¿ã„æ–¹

Express Generatorã®åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
npx express-generator myapp

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd myapp

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
DEBUG=myapp:* npm start
```

### ç”Ÿæˆã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
myapp/
â”œâ”€â”€ app.js              # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ package.json        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ www            # ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ public/            # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ javascripts/
â”‚   â””â”€â”€ stylesheets/
â”‚       â””â”€â”€ style.css
â”œâ”€â”€ routes/            # ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å®šç¾©
â”‚   â”œâ”€â”€ index.js
â”‚   â””â”€â”€ users.js
â””â”€â”€ views/             # ãƒ“ãƒ¥ãƒ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
    â”œâ”€â”€ error.pug
    â”œâ”€â”€ index.pug
    â””â”€â”€ layout.pug
```

## ã‚³ãƒãƒ³ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³

Express Generatorã«ã¯æ§˜ã€…ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ï¼š

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | ä½¿ç”¨ä¾‹ |
|-----------|------|--------|
| `-h, --help` | ãƒ˜ãƒ«ãƒ—æƒ…å ±ã‚’è¡¨ç¤º | `express -h` |
| `--version` | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤º | `express --version` |
| `-e, --ejs` | EJSãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ | `express -e myapp` |
| `--pug` | Pugãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ | `express --pug myapp` |
| `--hbs` | Handlebarsãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ | `express --hbs myapp` |
| `-H, --hogan` | Hoganãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ | `express -H myapp` |
| `-v, --view` | ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã‚’æŒ‡å®š | `express --view=ejs myapp` |
| `-c, --css` | CSSãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’æŒ‡å®š | `express --css=sass myapp` |
| `--git` | .gitignoreãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ | `express --git myapp` |
| `-f, --force` | æ—¢å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¼·åˆ¶çš„ã«ç”Ÿæˆ | `express -f myapp` |

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³

Express Generatorã¯è¤‡æ•°ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ãã‚Œãã‚Œã®ç‰¹å¾´ã‚’ç†è§£ã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æœ€é©ãªã‚‚ã®ã‚’é¸ã³ã¾ã—ã‚‡ã†ã€‚

### Pugï¼ˆæ—§Jadeï¼‰
- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®ç°¡æ½”ãªæ§‹æ–‡
- HTMLã‚¿ã‚°ã®çœç•¥ãŒå¯èƒ½
- å¼·åŠ›ãªãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³æ©Ÿèƒ½
- å­¦ç¿’æ›²ç·šãŒã‚„ã‚„æ€¥

### EJS
- HTMLã«è¿‘ã„æ§‹æ–‡
- JavaScriptã‚’ç›´æ¥åŸ‹ã‚è¾¼ã¿å¯èƒ½
- å­¦ç¿’ãŒå®¹æ˜“
- ã‚·ãƒ³ãƒ—ãƒ«ã§åˆ†ã‹ã‚Šã‚„ã™ã„

### Handlebars
- ãƒ­ã‚¸ãƒƒã‚¯ãƒ¬ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- Mustacheæ§‹æ–‡ã‚’æ‹¡å¼µ
- ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ãŒä½¿ãˆã‚‹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒé«˜ã„

### Hogan
- Mustacheäº’æ›
- éå¸¸ã«é«˜é€Ÿ
- è»½é‡ï¼ˆ3KBï¼‰
- Twitterç¤¾ãŒé–‹ç™º

## Pugã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª

Pugã‚’ä½¿ã£ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ

```bash
npx express-generator --view=pug pug-app
cd pug-app
npm install
```

### 2. ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ 

**views/layout.pug**

```pug
doctype html
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    block content
```

**views/index.pug**

```pug
extends layout

block content
  h1= title
  p Welcome to #{title}
```

### 3. ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹

**views/index.pug**ã‚’ç·¨é›†ã—ã¦ãƒšãƒ¼ã‚¸ã‚’æ‹¡å¼µï¼š

```pug
extends layout

block content
  .container
    h1= title
    p.lead Welcome to #{title} - Pugã§ä½œã‚‰ã‚ŒãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
    
    .features
      h2 ç‰¹å¾´
      ul
        li ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®ç°¡æ½”ãªæ§‹æ–‡
        li å¼·åŠ›ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç¶™æ‰¿
        li ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ã«ã‚ˆã‚‹å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    
    .example
      h3 å¤‰æ•°ã®ä½¿ç”¨ä¾‹
      - const items = ['Node.js', 'Express', 'Pug']
      ul
        each item in items
          li= item
    
    button.btn.btn-primary(type='button') 
      | ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„
```

### 4. ãƒ«ãƒ¼ã‚¿ãƒ¼ã®ä¿®æ­£

**routes/index.js**

```javascript
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { 
    title: 'Pug Express App',
    message: 'Pugãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™'
  });
});

module.exports = router;
```

### 5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•

```bash
DEBUG=pug-app:* npm start
```

## EJSã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª

EJSã‚’ä½¿ã£ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ

```bash
npx express-generator --view=ejs ejs-app
cd ejs-app
npm install
```

### 2. ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ 

**views/index.ejs**

```html
<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Welcome to <%= title %></p>
  </body>
</html>
```

### 3. ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®å®Ÿè£…

EJSã§ã¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ãŒãªã„ãŸã‚ã€ãƒ‘ãƒ¼ã‚·ãƒ£ãƒ«ã‚’ä½¿ã„ã¾ã™ã€‚

**views/partials/header.ejs**

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">EJS Express App</a>
        </div>
    </nav>
    <div class="container mt-4">
```

**views/partials/footer.ejs**

```html
    </div>
    <footer class="footer mt-5 py-3 bg-light">
        <div class="container text-center">
            <span class="text-muted">&copy; 2024 EJS Express App</span>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
```

### 4. ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸ index.ejs

```html
<%- include('partials/header') %>

<div class="row">
    <div class="col-md-8">
        <h1><%= title %></h1>
        <p class="lead">EJSãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</p>
        
        <h2>ç‰¹å¾´</h2>
        <ul>
            <li>HTMLã«è¿‘ã„æ§‹æ–‡ã§å­¦ç¿’ãŒå®¹æ˜“</li>
            <li>JavaScriptã‚³ãƒ¼ãƒ‰ã‚’ç›´æ¥åŸ‹ã‚è¾¼ã¿å¯èƒ½</li>
            <li>æ¡ä»¶åˆ†å²ã‚„ãƒ«ãƒ¼ãƒ—ãŒç°¡å˜ã«æ›¸ã‘ã‚‹</li>
        </ul>
        
        <h3>å‹•çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¾‹</h3>
        <% const technologies = ['Node.js', 'Express', 'EJS', 'Bootstrap']; %>
        <div class="row">
            <% technologies.forEach(function(tech) { %>
                <div class="col-md-3 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title"><%= tech %></h5>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
    
    <div class="col-md-4">
        <h3>ã‚µã‚¤ãƒ‰ãƒãƒ¼</h3>
        <% if (user) { %>
            <p>ã‚ˆã†ã“ãã€<%= user.name %>ã•ã‚“ï¼</p>
        <% } else { %>
            <p>ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™</p>
        <% } %>
    </div>
</div>

<%- include('partials/footer') %>
```

### 5. ãƒ«ãƒ¼ã‚¿ãƒ¼ã®æ›´æ–°

```javascript
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { 
    title: 'EJS Express App',
    user: { name: 'å¤ªéƒ' } // ã‚µãƒ³ãƒ—ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿
  });
});

module.exports = router;
```

## Handlebarsã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª

Handlebarsã‚’ä½¿ã£ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ

```bash
npx express-generator --view=hbs hbs-app
cd hbs-app
npm install
```

### 2. ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ 

**views/layout.hbs**

```handlebars
<!DOCTYPE html>
<html>
  <head>
    <title>{{title}}</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    {{{body}}}
  </body>
</html>
```

**views/index.hbs**

```handlebars
<h1>{{title}}</h1>
<p>Welcome to {{title}}</p>
```

### 3. ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã®è¿½åŠ 

**app.js**ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```javascript
// Handlebarsã®è¨­å®š
var hbs = require('hbs');

// ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒ«ãƒ‘ãƒ¼ã®ç™»éŒ²
hbs.registerHelper('uppercase', function(str) {
  return str.toUpperCase();
});

hbs.registerHelper('list', function(items, options) {
  var out = "<ul>";
  for(var i=0, l=items.length; i<l; i++) {
    out = out + "<li>" + options.fn(items[i]) + "</li>";
  }
  return out + "</ul>";
});

// ãƒ‘ãƒ¼ã‚·ãƒ£ãƒ«ã®ç™»éŒ²
hbs.registerPartials(__dirname + '/views/partials');
```

### 4. ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸãƒ“ãƒ¥ãƒ¼

**views/index.hbs**

```handlebars
<div class="container">
    <h1>{{uppercase title}}</h1>
    <p class="lead">Handlebarsãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</p>
    
    <h2>ç‰¹å¾´</h2>
    <ul>
        <li>ãƒ­ã‚¸ãƒƒã‚¯ãƒ¬ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</li>
        <li>Mustacheæ§‹æ–‡ã®æ‹¡å¼µç‰ˆ</li>
        <li>ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°</li>
        <li>ãƒ‘ãƒ¼ã‚·ãƒ£ãƒ«ã«ã‚ˆã‚‹å†åˆ©ç”¨</li>
    </ul>
    
    <h3>æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h3>
    {{#list technologies}}
        <strong>{{name}}</strong> - {{description}}
    {{/list}}
    
    {{#if showMessage}}
        <div class="alert alert-info">
            <p>{{message}}</p>
        </div>
    {{/if}}
    
    {{> userinfo user=currentUser}}
</div>
```

**views/partials/userinfo.hbs**

```handlebars
<div class="user-info">
    {{#if user}}
        <h4>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</h4>
        <p>åå‰: {{user.name}}</p>
        <p>ãƒ¡ãƒ¼ãƒ«: {{user.email}}</p>
    {{else}}
        <p>ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã¾ã›ã‚“</p>
    {{/if}}
</div>
```

### 5. ãƒ«ãƒ¼ã‚¿ãƒ¼ã®æ›´æ–°

```javascript
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { 
    title: 'Handlebars Express App',
    technologies: [
      { name: 'Node.js', description: 'JavaScriptãƒ©ãƒ³ã‚¿ã‚¤ãƒ ' },
      { name: 'Express', description: 'Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯' },
      { name: 'Handlebars', description: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³' }
    ],
    showMessage: true,
    message: 'Handlebarsã¯å®‰å…¨ã§ä½¿ã„ã‚„ã™ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã™',
    currentUser: {
      name: 'å±±ç”°å¤ªéƒ',
      email: 'taro@example.com'
    }
  });
});

module.exports = router;
```

## Hoganã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒª

Hoganã‚’ä½¿ã£ãŸExpressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆ

```bash
npx express-generator --view=hogan hogan-app
cd hogan-app
npm install
```

> **âš ï¸ æ³¨æ„**: Hoganãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ç”¨ã—ãŸå ´åˆã€ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã›ã‚“ã€‚æ‰‹å‹•ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### 2. ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

**views/index.hjs**ã‚’ä½œæˆï¼š

```html
<!DOCTYPE html>
<html>
  <head>
    <title>{{ title }}</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <div class="container">
      <h1>{{ title }}</h1>
      <p class="lead">{{ description }}</p>
      
      <h2>ç‰¹å¾´</h2>
      <ul>
        {{#features}}
          <li>{{ . }}</li>
        {{/features}}
      </ul>
      
      <h3>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
      <p>Hoganã¯{{ performance }}ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚</p>
      
      {{#showBenchmark}}
      <div class="benchmark">
        <h4>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ</h4>
        <table class="table">
          <thead>
            <tr>
              <th>ã‚¨ãƒ³ã‚¸ãƒ³</th>
              <th>å‡¦ç†æ™‚é–“</th>
            </tr>
          </thead>
          <tbody>
            {{#benchmarks}}
            <tr>
              <td>{{ engine }}</td>
              <td>{{ time }}ms</td>
            </tr>
            {{/benchmarks}}
          </tbody>
        </table>
      </div>
      {{/showBenchmark}}
    </div>
  </body>
</html>
```

**views/error.hjs**ã‚’ä½œæˆï¼š

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Error</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1>{{ message }}</h1>
    <h2>{{ error.status }}</h2>
    <pre>{{ error.stack }}</pre>
  </body>
</html>
```

### 3. app.jsã®è¨­å®š

```javascript
// view engine setup
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'hjs');

// Hoganã®è¨­å®šã‚’è¿½åŠ 
app.engine('hjs', require('hogan-express'));
```

### 4. ãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®š

**routes/index.js**

```javascript
var express = require('express');
var router = express.Router();

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', {
    title: 'Hogan Express App',
    description: 'Hogan.jsã¯ã€TwitterãŒé–‹ç™ºã—ãŸé«˜é€Ÿã§è»½é‡ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã™',
    features: [
      'Mustacheæ§‹æ–‡ã«å®Œå…¨æº–æ‹ ',
      'éå¸¸ã«é«˜é€Ÿãªå‡¦ç†',
      'è»½é‡ï¼ˆã‚ãšã‹3KBï¼‰',
      'ãƒ–ãƒ©ã‚¦ã‚¶ã¨Node.jsä¸¡æ–¹ã§å‹•ä½œ'
    ],
    performance: 'éå¸¸ã«é«˜é€Ÿ',
    showBenchmark: true,
    benchmarks: [
      { engine: 'Hogan', time: 12 },
      { engine: 'Handlebars', time: 45 },
      { engine: 'EJS', time: 67 },
      { engine: 'Pug', time: 89 }
    ]
  });
});

module.exports = router;
```

### 5. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è¿½åŠ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install hogan-express --save
```

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®æ¯”è¼ƒ

å„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ç‰¹å¾´ã‚’æ¯”è¼ƒã—ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æœ€é©ãªã‚‚ã®ã‚’é¸ã³ã¾ã—ã‚‡ã†ã€‚

| ç‰¹å¾´ | Pug | EJS | Handlebars | Hogan |
|------|-----|-----|------------|-------|
| **æ§‹æ–‡** | ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ | HTMLåŸ‹ã‚è¾¼ã¿ | Mustacheæ‹¡å¼µ | Mustacheæº–æ‹  |
| **å­¦ç¿’æ›²ç·š** | ã‚„ã‚„æ€¥ | ç·©ã‚„ã‹ | æ™®é€š | ç·©ã‚„ã‹ |
| **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹** | æ™®é€š | é«˜é€Ÿ | æ™®é€š | éå¸¸ã«é«˜é€Ÿ |
| **ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º** | å¤§ãã„ | ä¸­ç¨‹åº¦ | ä¸­ç¨‹åº¦ | éå¸¸ã«å°ã•ã„ï¼ˆ3KBï¼‰ |
| **æ©Ÿèƒ½æ€§** | éå¸¸ã«è±Šå¯Œ | è±Šå¯Œ | é©åº¦ | æœ€å°é™ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | é«˜ã„ | è¦æ³¨æ„ | éå¸¸ã«é«˜ã„ | é«˜ã„ |
| **ãŠã™ã™ã‚ç”¨é€”** | è¤‡é›‘ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ | ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒª | å¤§è¦æ¨¡ã‚¢ãƒ—ãƒª | é«˜é€Ÿæ€§é‡è¦– |

### é¸æŠã®æŒ‡é‡

#### Pugã‚’é¸ã¶ã¹ãå ´åˆ
- HTMLã®è¨˜è¿°é‡ã‚’æ¸›ã‚‰ã—ãŸã„
- å¼·åŠ›ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç¶™æ‰¿ãŒå¿…è¦
- ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ãŒPugã«æ…£ã‚Œã¦ã„ã‚‹

#### EJSã‚’é¸ã¶ã¹ãå ´åˆ
- HTMLã®çŸ¥è­˜ã‚’ãã®ã¾ã¾æ´»ã‹ã—ãŸã„
- JavaScriptã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç›´æ¥æ›¸ããŸã„
- å­¦ç¿’ã‚³ã‚¹ãƒˆã‚’æœ€å°é™ã«ã—ãŸã„

#### Handlebarsã‚’é¸ã¶ã¹ãå ´åˆ
- ãƒ“ãƒ¥ãƒ¼ã¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ãŸã„
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’é‡è¦–ã™ã‚‹
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã‚‚åŒã˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã„ãŸã„

#### Hoganã‚’é¸ã¶ã¹ãå ´åˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€å„ªå…ˆ
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æœ€å°é™ã«ã—ãŸã„
- ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½ã§ååˆ†

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

Express Generatorã‚’ä½¿ã£ãŸé–‹ç™ºã§æ¨å¥¨ã•ã‚Œã‚‹å®Ÿè·µçš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã§ã™ã€‚

### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æ‹¡å¼µ

ç”Ÿæˆã•ã‚ŒãŸåŸºæœ¬æ§‹é€ ã‚’ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¦æ¨¡ã«å¿œã˜ã¦æ‹¡å¼µã—ã¾ã—ã‚‡ã†ï¼š

```
myapp/
â”œâ”€â”€ app.js
â”œâ”€â”€ package.json
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ www
â”œâ”€â”€ config/           # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ database.js
â”‚   â””â”€â”€ auth.js
â”œâ”€â”€ controllers/      # ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤
â”‚   â”œâ”€â”€ userController.js
â”‚   â””â”€â”€ productController.js
â”œâ”€â”€ models/          # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ User.js
â”‚   â””â”€â”€ Product.js
â”œâ”€â”€ middleware/      # ã‚«ã‚¹ã‚¿ãƒ ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”œâ”€â”€ auth.js
â”‚   â””â”€â”€ validation.js
â”œâ”€â”€ public/
â”œâ”€â”€ routes/
â”œâ”€â”€ views/
â”œâ”€â”€ tests/           # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ unit/
â”‚   â””â”€â”€ integration/
â””â”€â”€ utils/           # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
    â””â”€â”€ helpers.js
```

### 2. ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†

**.env**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ç’°å¢ƒè¨­å®šã‚’ç®¡ç†ï¼š

```bash
npm install dotenv --save
```

**.env**

```
NODE_ENV=development
PORT=3000
DATABASE_URL=mongodb://localhost:27017/myapp
SESSION_SECRET=your-secret-key
```

**app.js**ã®å…ˆé ­ã«è¿½åŠ ï¼š

```javascript
require('dotenv').config();
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„

```javascript
// ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
app.use((err, req, res, next) => {
  // ãƒ­ã‚°è¨˜éŒ²
  console.error(err.stack);
  
  // é–‹ç™ºç’°å¢ƒã§ã¯è©³ç´°ãªã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’è¡¨ç¤º
  if (app.get('env') === 'development') {
    res.status(err.status || 500);
    res.render('error', {
      message: err.message,
      error: err
    });
  } else {
    // æœ¬ç•ªç’°å¢ƒã§ã¯ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    res.status(err.status || 500);
    res.render('error', {
      message: 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
      error: {}
    });
  }
});
```

### 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å¼·åŒ–

```bash
npm install helmet cors express-rate-limit --save
```

```javascript
const helmet = require('helmet');
const cors = require('cors');
const rateLimit = require('express-rate-limit');

// ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š
app.use(helmet());

// CORSè¨­å®š
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(',') || '*'
}));

// ãƒ¬ãƒ¼ãƒˆåˆ¶é™
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 100 // ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã®ä¸Šé™
});
app.use('/api/', limiter);
```

### 5. ãƒ­ã‚®ãƒ³ã‚°ã®å®Ÿè£…

```bash
npm install winston --save
```

```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  defaultMeta: { service: 'user-service' },
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}
```

### 6. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®æº–å‚™

**package.json**ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ï¼š

```json
{
  "scripts": {
    "start": "node ./bin/www",
    "dev": "nodemon ./bin/www",
    "test": "jest",
    "lint": "eslint .",
    "build": "npm run lint && npm test"
  }
}
```

**ãƒ—ãƒ­ã‚»ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼ˆPM2ï¼‰ã®ä½¿ç”¨**

```bash
# PM2ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install pm2 -g

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•
pm2 start ./bin/www --name myapp

# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
pm2 start ./bin/www -i max --name myapp
```

## ã¾ã¨ã‚

Express Application Generatorã¯ã€Expressã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹ç™ºã‚’ç´ æ—©ãå§‹ã‚ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§å­¦ã‚“ã å†…å®¹ã‚’æ´»ç”¨ã—ã¦ã€åŠ¹ç‡çš„ã«Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†ã€‚

### å­¦ã‚“ã ã“ã¨
- Express Generatorã®åŸºæœ¬çš„ãªä½¿ã„æ–¹
- 4ã¤ã®ä¸»è¦ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ç‰¹å¾´
- å„ã‚¨ãƒ³ã‚¸ãƒ³ã§ã®å®Ÿè£…æ–¹æ³•
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æ‹¡å¼µæ–¹æ³•

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®é€£æº
- èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…
- RESTful APIã®æ§‹ç¯‰
- å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®é©ç”¨

---

*ç´„ 1æ™‚é–“ã§å®Œäº† | ä¸­ç´šãƒ¬ãƒ™ãƒ« | æœ€çµ‚æ›´æ–°: 2024å¹´*