<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Node.js„ÅßMongoDB„ÄÅPostgreSQL„ÄÅRedis„Çí‰Ωø„Å£„Åü„Éá„Éº„Çø„Éô„Éº„ÇπÈÄ£Êê∫„ÇíÂ≠¶„Å∂ÂåÖÊã¨ÁöÑ„Å™„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´">
    <meta name="keywords" content="Node.js, MongoDB, PostgreSQL, Redis, Mongoose, Sequelize, „Éá„Éº„Çø„Éô„Éº„Çπ, ORM">
    <title>„Éá„Éº„Çø„Éô„Éº„ÇπÈÄ£Êê∫„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´ - Node.js</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üóÑÔ∏è</text></svg>">
    
    <!-- Stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #339933;
            --secondary-color: #68217a;
            --accent-color: #f39c12;
            --dark-color: #2c3e50;
            --text-color: #333;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f8f9fa;
            padding-top: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        main {
            padding: 2rem 0;
            background: white;
            min-height: calc(100vh - 200px);
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: var(--dark-color);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        h1 {
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 1rem;
            font-size: 2.5rem;
        }
        
        h2 {
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 8px;
            font-size: 2rem;
            color: var(--primary-color);
        }
        
        h3 {
            font-size: 1.5rem;
            color: var(--secondary-color);
        }
        
        /* „Ç≥„Éº„Éâ„Çπ„Çø„Ç§„É´ */
        code {
            background-color: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #d73a49;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #2d3748 !important;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            position: relative;
            box-shadow: var(--shadow);
        }
        
        pre code {
            background-color: transparent !important;
            padding: 0;
            color: #e2e8f0 !important;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Prism.js „ÅÆ„Ç´„Çπ„Çø„Éû„Ç§„Ç∫ */
        .token.comment,
        .token.prolog,
        .token.doctype,
        .token.cdata {
            color: #68d391;
        }
        
        .token.punctuation {
            color: #e2e8f0;
        }
        
        .token.property,
        .token.tag,
        .token.boolean,
        .token.number,
        .token.constant,
        .token.symbol,
        .token.deleted {
            color: #f6e05e;
        }
        
        .token.selector,
        .token.attr-name,
        .token.string,
        .token.char,
        .token.builtin,
        .token.inserted {
            color: #fc8181;
        }
        
        .token.operator,
        .token.entity,
        .token.url,
        .language-css .token.string,
        .style .token.string {
            color: #90cdf4;
        }
        
        .token.atrule,
        .token.attr-value,
        .token.keyword {
            color: #90cdf4;
        }
        
        .token.function,
        .token.class-name {
            color: #b794f6;
        }
        
        .token.regex,
        .token.important,
        .token.variable {
            color: #fbb6ce;
        }
        
        /* „ÉÜ„Éº„Éñ„É´„Çπ„Çø„Ç§„É´ */
        .table-responsive {
            margin: 1.5rem 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        table {
            margin-bottom: 0;
        }
        
        .table-dark th {
            background-color: var(--dark-color) !important;
            border-color: var(--border-color);
        }
        
        /* „É™„Çπ„Éà„Çπ„Çø„Ç§„É´ */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }
        
        li {
            margin: 0.5rem 0;
        }
        
        /* Ë≠¶Âëä„Éª„Éí„É≥„Éà„Éú„ÉÉ„ÇØ„Çπ */
        .alert {
            margin: 1.5rem 0;
            padding: 1.5rem;
            border-radius: 8px;
            border: none;
            box-shadow: var(--shadow);
        }
        
        .alert-info {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            color: #1565c0;
        }
        
        .alert-warning {
            background: linear-gradient(135deg, #fff3e0, #ffcc02);
            color: #e65100;
        }
        
        .alert-success {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            color: #2e7d32;
        }
        
        .alert-danger {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            color: #c62828;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 4px solid #2196f3;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            box-shadow: var(--shadow);
        }
        
        .tip-box {
            background: linear-gradient(135deg, #fff3e0, #ffcc02);
            border-left: 4px solid #ff9800;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            box-shadow: var(--shadow);
        }
        
        .warning-box {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-left: 4px solid #f44336;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            box-shadow: var(--shadow);
        }
        
        /* „Ç∞„É™„ÉÉ„Éâ„É¨„Ç§„Ç¢„Ç¶„Éà */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .comparison-item {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }
        
        .comparison-item h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
        }
        
        .comparison-item h4 {
            color: var(--secondary-color);
            margin-top: 0;
            margin-bottom: 1rem;
        }
        
        .best-practices-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .practice-item {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }
        
        .practice-item h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 1rem;
        }
        
        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .btn {
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            margin: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), #2e7d32);
            border: none;
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(51, 153, 51, 0.3);
        }
        
        .btn-outline-primary {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
        }
        
        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }
        
        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }
        
        .nav-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .nav-menu li {
            margin: 0 1rem;
        }
        
        .nav-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .best-practices-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-toggle {
                display: block;
            }
            
            .nav-menu {
                position: fixed;
                top: 60px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 60px);
                background: rgba(46, 125, 50, 0.95);
                flex-direction: column;
                justify-content: start;
                align-items: center;
                padding-top: 2rem;
                transition: left 0.3s ease;
            }
            
            .nav-menu.active {
                left: 0;
            }
            
            .nav-menu li {
                margin: 1rem 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" style="background: linear-gradient(135deg, #2e7d32 0%, #1976d2 100%); padding: 1rem 0; margin-bottom: 0;">
        <nav class="navbar" style="background: transparent;">
            <a href="index.html" class="logo" style="color: white;">Node.js Tutorial</a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link" style="color: white;">„Éõ„Éº„É†</a></li>
                <li><a href="nodejs-tutorial.html" class="nav-link" style="color: white;">Node.jsÂü∫Á§é</a></li>
                <li><a href="express-tutorial.html" class="nav-link" style="color: white;">Express.js</a></li>
                <li><a href="express-generator-tutorial.html" class="nav-link" style="color: white;">Express Generator</a></li>
                <li><a href="#" class="nav-link active" style="color: white; font-weight: bold;">„Éá„Éº„Çø„Éô„Éº„ÇπÈÄ£Êê∫</a></li>
            </ul>
            <button class="nav-toggle" aria-label="„É°„Éã„É•„Éº„ÇíÈñã„Åè" style="color: white;">
                <i class="fas fa-bars"></i>
            </button>
        </nav>
    </header>

    <div class="container">
        <div style="background: linear-gradient(135deg, #2e7d32 0%, #1976d2 100%); margin: -2rem -2rem 2rem -2rem; padding: 3rem 2rem; text-align: center; color: white;">
            <h1 style="color: white; border-bottom: none; margin: 0;">„Éá„Éº„Çø„Éô„Éº„ÇπÈÄ£Êê∫„Éû„Çπ„Çø„Éº„Ç≥„Éº„Çπ</h1>
            <p style="font-size: 1.2rem; margin: 1rem 0;">MongoDB„ÄÅPostgreSQL„ÄÅRedis„Çí‰Ωø„Å£„ÅüÊú¨Ê†ºÁöÑ„Å™„Éá„Éº„Çø„Éô„Éº„ÇπË®≠Ë®à„Å®ÂÆüË£Ö</p>
            <div style="margin-top: 1.5rem;">
                <span style="margin: 0 1rem;"><i class="fas fa-clock"></i> Á¥Ñ 4-5ÊôÇÈñì</span>
                <span style="margin: 0 1rem;"><i class="fas fa-signal"></i> ‰∏äÁ¥ö</span>
                <span style="margin: 0 1rem;"><i class="fas fa-calendar"></i> ÊúÄÁµÇÊõ¥Êñ∞: 2024Âπ¥</span>
            </div>
        </div>

        <main>
            <!-- Introduction -->
            <section id="introduction" class="tutorial-section">
                <h2>„ÅØ„Åò„ÇÅ„Å´</h2>
                <p>Áèæ‰ª£„ÅÆWeb„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÈñãÁô∫„Å´„Åä„ÅÑ„Å¶„ÄÅ„Éá„Éº„Çø„Éô„Éº„Çπ„ÅØ‰∏çÂèØÊ¨†„Å™Ë¶ÅÁ¥†„Åß„Åô„ÄÇ„Åì„ÅÆ„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´„Åß„ÅØ„ÄÅNode.js„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅßÊúÄ„ÇÇ‰∫∫Ê∞ó„ÅÆ„ÅÇ„Çã3„Å§„ÅÆ„Éá„Éº„Çø„Éô„Éº„ÇπÊäÄË°ì„Å´„Å§„ÅÑ„Å¶Â≠¶„Å≥„Åæ„Åô„ÄÇ</p>
                
                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> „Åì„ÅÆ„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´„ÅßÂ≠¶„Åπ„Çã„Åì„Å®</h4>
                    <ul>
                        <li>MongoDBÔºàNoSQLÔºâ„Å®Mongoose„Çí‰Ωø„Å£„Åü„Éâ„Ç≠„É•„É°„É≥„ÉàÊåáÂêë„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÊìç‰Ωú</li>
                        <li>PostgreSQLÔºàSQLÔºâ„Å®Sequelize„Çí‰Ωø„Å£„Åü„É™„É¨„Éº„Ç∑„Éß„Éä„É´„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÁÆ°ÁêÜ</li>
                        <li>Redis„Çí‰Ωø„Å£„ÅüÈ´òÈÄü„Ç≠„É£„ÉÉ„Ç∑„É≥„Ç∞„Ç∑„Çπ„ÉÜ„É†„ÅÆÂÆüË£Ö</li>
                        <li>„Éá„Éº„Çø„Éô„Éº„ÇπË®≠Ë®à„ÅÆÂéüÂâá„Å®„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ</li>
                        <li>Êú¨Áï™Áí∞Â¢É„Åß„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ„Å®„Çπ„Ç±„Éº„É™„É≥„Ç∞</li>
                    </ul>
                </div>

                <h3>„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÈÅ∏ÊäûÂü∫Ê∫ñ</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>MongoDB</h4>
                        <ul>
                            <li>„Çπ„Ç≠„Éº„Éû„É¨„Çπ„ÅßÊüîËªü„Å™„Éá„Éº„ÇøÊßãÈÄ†</li>
                            <li>Ê∞¥Âπ≥„Çπ„Ç±„Éº„É™„É≥„Ç∞„ÅåÂÆπÊòì</li>
                            <li>JSON„É©„Ç§„ÇØ„Å™„Éâ„Ç≠„É•„É°„É≥„ÉàÂΩ¢Âºè</li>
                            <li>„É™„Ç¢„É´„Çø„Ç§„É†„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´ÊúÄÈÅ©</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <h4>PostgreSQL</h4>
                        <ul>
                            <li>ACIDÊ∫ñÊã†„ÅÆÂº∑Âäõ„Å™„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥</li>
                            <li>Ë§áÈõë„Å™„ÇØ„Ç®„É™„Å®ÁµêÂêà„Å´ÂÑ™„Çå„Çã</li>
                            <li>„Éá„Éº„ÇøÊï¥ÂêàÊÄß„ÅåÈáçË¶Å„Å™Â†¥Âêà„Å´ÊúÄÈÅ©</li>
                            <li>Ë±äÂØå„Å™Êã°ÂºµÊ©üËÉΩ„Å®„Éá„Éº„ÇøÂûã</li>
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <h4>Redis</h4>
                        <ul>
                            <li>„Ç§„É≥„É°„É¢„É™„Éá„Éº„Çø„Çπ„Éà„Ç¢</li>
                            <li>Ë∂ÖÈ´òÈÄü„Å™Ë™≠„ÅøÊõ∏„ÅçÊÄßËÉΩ</li>
                            <li>„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÇÑ„Ç≠„É£„ÉÉ„Ç∑„É•„Å´ÊúÄÈÅ©</li>
                            <li>Pub/SubÊ©üËÉΩ„Åß„É™„Ç¢„É´„Çø„Ç§„É†ÈÄö‰ø°</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- MongoDB and Mongoose -->
            <section id="mongodb-mongoose" class="tutorial-section">
                <h2>MongoDB „Å® Mongoose</h2>
                <p>MongoDB„ÅØÊúÄ„ÇÇ‰∫∫Ê∞ó„ÅÆ„ÅÇ„ÇãNoSQL„Éá„Éº„Çø„Éô„Éº„Çπ„Åß„ÄÅMongoose„ÅØ„Åù„ÅÆ„Åü„ÇÅ„ÅÆÂº∑Âäõ„Å™ODMÔºàObject Document MapperÔºâ„Åß„Åô„ÄÇ</p>

                <h3>1. „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó</h3>
                <pre><code class="language-bash"># MongoDB„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÔºàmacOSÔºâ
brew tap mongodb/brew
brew install mongodb-community

# MongoDB„ÅÆËµ∑Âãï
brew services start mongodb-community

# Mongoose„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
npm install mongoose</code></pre>

                <h3>2. Êé•Á∂öË®≠ÂÆö</h3>
                <p><strong>config/database.js</strong></p>
                <pre><code class="language-javascript">const mongoose = require('mongoose');

const connectDB = async () => {
  try {
    const conn = await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/myapp', {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    });
    
    console.log(`MongoDB Connected: ${conn.connection.host}`);
    
    // Êé•Á∂ö„Ç§„Éô„É≥„Éà„ÅÆ„É™„Çπ„Éä„Éº
    mongoose.connection.on('error', err => {
      console.error('MongoDB connection error:', err);
    });
    
    mongoose.connection.on('disconnected', () => {
      console.log('MongoDB disconnected');
    });
    
    // „Ç∞„É¨„Éº„Çπ„Éï„É´„Ç∑„É£„ÉÉ„Éà„ÉÄ„Ç¶„É≥
    process.on('SIGINT', async () => {
      await mongoose.connection.close();
      process.exit(0);
    });
  } catch (error) {
    console.error('Error connecting to MongoDB:', error);
    process.exit(1);
  }
};

module.exports = connectDB;</code></pre>

                <h3>3. „Çπ„Ç≠„Éº„Éû„Å®„É¢„Éá„É´„ÅÆÂÆöÁæ©</h3>
                <p><strong>models/User.js</strong></p>
                <pre><code class="language-javascript">const mongoose = require('mongoose');
const bcrypt = require('bcryptjs');

const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: [true, 'ÂêçÂâç„ÅØÂøÖÈ†à„Åß„Åô'],
    trim: true,
    maxlength: [50, 'ÂêçÂâç„ÅØ50ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ']
  },
  email: {
    type: String,
    required: [true, '„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÂøÖÈ†à„Åß„Åô'],
    unique: true,
    lowercase: true,
    validate: {
      validator: function(v) {
        return /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(v);
      },
      message: 'ÊúâÂäπ„Å™„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'
    }
  },
  password: {
    type: String,
    required: [true, '„Éë„Çπ„ÉØ„Éº„Éâ„ÅØÂøÖÈ†à„Åß„Åô'],
    minlength: [6, '„Éë„Çπ„ÉØ„Éº„Éâ„ÅØ6ÊñáÂ≠ó‰ª•‰∏ä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ'],
    select: false // „Éá„Éï„Ç©„É´„Éà„Åß„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂèñÂæó„Åó„Å™„ÅÑ
  },
  role: {
    type: String,
    enum: ['user', 'admin'],
    default: 'user'
  },
  profile: {
    bio: String,
    avatar: String,
    social: {
      twitter: String,
      facebook: String,
      linkedin: String
    }
  },
  posts: [{
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Post'
  }],
  createdAt: {
    type: Date,
    default: Date.now
  },
  lastLogin: Date,
  isActive: {
    type: Boolean,
    default: true
  }
}, {
  timestamps: true,
  toJSON: { virtuals: true },
  toObject: { virtuals: true }
});

// „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆË®≠ÂÆö
userSchema.index({ email: 1 });
userSchema.index({ createdAt: -1 });
userSchema.index({ name: 'text', 'profile.bio': 'text' });

// ‰ªÆÊÉ≥„Éó„É≠„Éë„ÉÜ„Ç£
userSchema.virtual('fullName').get(function() {
  return this.name;
});

userSchema.virtual('postCount').get(function() {
  return this.posts.length;
});

// „Éü„Éâ„É´„Ç¶„Çß„Ç¢ - ‰øùÂ≠òÂâç„Å´„Éë„Çπ„ÉØ„Éº„Éâ„Çí„Éè„ÉÉ„Ç∑„É•Âåñ
userSchema.pre('save', async function(next) {
  if (!this.isModified('password')) return next();
  
  try {
    const salt = await bcrypt.genSalt(10);
    this.password = await bcrypt.hash(this.password, salt);
    next();
  } catch (error) {
    next(error);
  }
});

// „Ç§„É≥„Çπ„Çø„É≥„Çπ„É°„ÇΩ„ÉÉ„Éâ
userSchema.methods.comparePassword = async function(candidatePassword) {
  return await bcrypt.compare(candidatePassword, this.password);
};

userSchema.methods.toJSON = function() {
  const obj = this.toObject();
  delete obj.password;
  delete obj.__v;
  return obj;
};

// ÈùôÁöÑ„É°„ÇΩ„ÉÉ„Éâ
userSchema.statics.findByEmail = function(email) {
  return this.findOne({ email: email.toLowerCase() });
};

userSchema.statics.findActiveUsers = function() {
  return this.find({ isActive: true });
};

const User = mongoose.model('User', userSchema);

module.exports = User;</code></pre>

                <p><strong>models/Post.js</strong></p>
                <pre><code class="language-javascript">const mongoose = require('mongoose');

const postSchema = new mongoose.Schema({
  title: {
    type: String,
    required: [true, '„Çø„Ç§„Éà„É´„ÅØÂøÖÈ†à„Åß„Åô'],
    trim: true,
    maxlength: [100, '„Çø„Ç§„Éà„É´„ÅØ100ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ']
  },
  slug: {
    type: String,
    unique: true,
    lowercase: true
  },
  content: {
    type: String,
    required: [true, 'ÂÜÖÂÆπ„ÅØÂøÖÈ†à„Åß„Åô']
  },
  excerpt: {
    type: String,
    maxlength: [200, 'ÊäúÁ≤ã„ÅØ200ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ']
  },
  author: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
    required: true
  },
  category: {
    type: String,
    required: true,
    enum: ['ÊäÄË°ì', '„É©„Ç§„Éï„Çπ„Çø„Ç§„É´', '„Éì„Ç∏„Éç„Çπ', '„Åù„ÅÆ‰ªñ']
  },
  tags: [{
    type: String,
    lowercase: true
  }],
  images: [{
    url: String,
    caption: String
  }],
  status: {
    type: String,
    enum: ['draft', 'published', 'archived'],
    default: 'draft'
  },
  views: {
    type: Number,
    default: 0
  },
  likes: [{
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'User'
    },
    createdAt: {
      type: Date,
      default: Date.now
    }
  }],
  comments: [{
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'User'
    },
    content: String,
    createdAt: {
      type: Date,
      default: Date.now
    }
  }],
  publishedAt: Date,
  metadata: {
    readTime: Number,
    seoTitle: String,
    seoDescription: String,
    seoKeywords: [String]
  }
}, {
  timestamps: true
});

// „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ
postSchema.index({ slug: 1 });
postSchema.index({ author: 1, status: 1 });
postSchema.index({ tags: 1 });
postSchema.index({ title: 'text', content: 'text' });

// ‰øùÂ≠òÂâç„Å´„Çπ„É©„ÉÉ„Ç∞„ÇíÁîüÊàê
postSchema.pre('save', function(next) {
  if (this.isModified('title')) {
    this.slug = this.title
      .toLowerCase()
      .replace(/[^\w\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .trim();
  }
  
  // ÊäúÁ≤ã„ÇíËá™ÂãïÁîüÊàê
  if (!this.excerpt && this.content) {
    this.excerpt = this.content.substring(0, 197) + '...';
  }
  
  // Ë™≠‰∫ÜÊôÇÈñì„ÇíË®àÁÆóÔºà1ÂàÜ„ÅÇ„Åü„Çä200ÊñáÂ≠óÔºâ
  if (this.content) {
    this.metadata.readTime = Math.ceil(this.content.length / 200);
  }
  
  next();
});

// ÂÖ¨ÈñãÊôÇ„Å´Êó•‰ªò„ÇíË®≠ÂÆö
postSchema.pre('save', function(next) {
  if (this.isModified('status') && this.status === 'published' && !this.publishedAt) {
    this.publishedAt = new Date();
  }
  next();
});

// „É°„ÇΩ„ÉÉ„Éâ
postSchema.methods.incrementViews = async function() {
  this.views += 1;
  return this.save();
};

postSchema.methods.addComment = async function(userId, content) {
  this.comments.push({ user: userId, content });
  return this.save();
};

postSchema.methods.toggleLike = async function(userId) {
  const likeIndex = this.likes.findIndex(like => 
    like.user.toString() === userId.toString()
  );
  
  if (likeIndex > -1) {
    this.likes.splice(likeIndex, 1);
  } else {
    this.likes.push({ user: userId });
  }
  
  return this.save();
};

// ÈùôÁöÑ„É°„ÇΩ„ÉÉ„Éâ
postSchema.statics.findPublished = function() {
  return this.find({ status: 'published' })
    .sort('-publishedAt')
    .populate('author', 'name email');
};

postSchema.statics.findBySlug = function(slug) {
  return this.findOne({ slug })
    .populate('author', 'name email profile.avatar');
};

postSchema.statics.searchPosts = function(query) {
  return this.find(
    { $text: { $search: query } },
    { score: { $meta: 'textScore' } }
  ).sort({ score: { $meta: 'textScore' } });
};

const Post = mongoose.model('Post', postSchema);

module.exports = Post;</code></pre>

                <h3>4. CRUDÊìç‰Ωú„ÅÆÂÆüË£Ö</h3>
                <p><strong>controllers/userController.js</strong></p>
                <pre><code class="language-javascript">const User = require('../models/User');
const catchAsync = require('../utils/catchAsync');
const AppError = require('../utils/appError');

// „É¶„Éº„Ç∂„Éº‰∏ÄË¶ßÂèñÂæó
exports.getUsers = catchAsync(async (req, res, next) => {
  // „ÇØ„Ç®„É™„Éì„É´„ÉÄ„Éº
  const query = User.find();
  
  // „Éï„Ç£„É´„Çø„É™„É≥„Ç∞
  if (req.query.role) {
    query.where('role').equals(req.query.role);
  }
  
  if (req.query.active) {
    query.where('isActive').equals(req.query.active === 'true');
  }
  
  // Ê§úÁ¥¢
  if (req.query.search) {
    query.where('name').regex(new RegExp(req.query.search, 'i'));
  }
  
  // „ÇΩ„Éº„Éà
  const sortBy = req.query.sortBy || '-createdAt';
  query.sort(sortBy);
  
  // „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥
  const page = parseInt(req.query.page, 10) || 1;
  const limit = parseInt(req.query.limit, 10) || 10;
  const skip = (page - 1) * limit;
  
  query.skip(skip).limit(limit);
  
  // „Éï„Ç£„Éº„É´„ÉâÈÅ∏Êäû
  if (req.query.fields) {
    const fields = req.query.fields.split(',').join(' ');
    query.select(fields);
  }
  
  // „Éù„Éî„É•„É¨„Éº„Éà
  query.populate('posts', 'title status publishedAt');
  
  // ÂÆüË°å
  const users = await query;
  
  // Á∑èÊï∞„ÇíÂèñÂæó
  const total = await User.countDocuments();
  
  res.json({
    status: 'success',
    results: users.length,
    total,
    page,
    pages: Math.ceil(total / limit),
    data: users
  });
});

// Âçò‰∏Ä„É¶„Éº„Ç∂„ÉºÂèñÂæó
exports.getUser = catchAsync(async (req, res, next) => {
  const user = await User.findById(req.params.id)
    .populate({
      path: 'posts',
      select: 'title slug status publishedAt views',
      match: { status: 'published' },
      options: { sort: '-publishedAt', limit: 10 }
    });
  
  if (!user) {
    return next(new AppError('„É¶„Éº„Ç∂„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 404));
  }
  
  res.json({
    status: 'success',
    data: user
  });
});

// „É¶„Éº„Ç∂„Éº‰ΩúÊàê
exports.createUser = catchAsync(async (req, res, next) => {
  const newUser = await User.create({
    name: req.body.name,
    email: req.body.email,
    password: req.body.password,
    role: req.body.role
  });
  
  res.status(201).json({
    status: 'success',
    data: newUser
  });
});

// „É¶„Éº„Ç∂„ÉºÊõ¥Êñ∞
exports.updateUser = catchAsync(async (req, res, next) => {
  const allowedUpdates = ['name', 'email', 'profile', 'isActive'];
  const updates = Object.keys(req.body)
    .filter(key => allowedUpdates.includes(key))
    .reduce((obj, key) => {
      obj[key] = req.body[key];
      return obj;
    }, {});
  
  const user = await User.findByIdAndUpdate(
    req.params.id,
    updates,
    {
      new: true,
      runValidators: true
    }
  );
  
  if (!user) {
    return next(new AppError('„É¶„Éº„Ç∂„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 404));
  }
  
  res.json({
    status: 'success',
    data: user
  });
});

// „É¶„Éº„Ç∂„ÉºÂâäÈô§
exports.deleteUser = catchAsync(async (req, res, next) => {
  const user = await User.findByIdAndDelete(req.params.id);
  
  if (!user) {
    return next(new AppError('„É¶„Éº„Ç∂„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 404));
  }
  
  res.status(204).json({
    status: 'success',
    data: null
  });
});

// Áµ±Ë®àÊÉÖÂ†±
exports.getUserStats = catchAsync(async (req, res, next) => {
  const stats = await User.aggregate([
    {
      $match: { isActive: true }
    },
    {
      $group: {
        _id: '$role',
        count: { $sum: 1 },
        avgPostCount: { $avg: { $size: '$posts' } }
      }
    },
    {
      $sort: { count: -1 }
    }
  ]);
  
  const monthlySignups = await User.aggregate([
    {
      $group: {
        _id: {
          year: { $year: '$createdAt' },
          month: { $month: '$createdAt' }
        },
        count: { $sum: 1 }
      }
    },
    {
      $sort: { '_id.year': -1, '_id.month': -1 }
    },
    {
      $limit: 12
    }
  ]);
  
  res.json({
    status: 'success',
    data: {
      roleStats: stats,
      monthlySignups
    }
  });
});</code></pre>

                <h3>5. È´òÂ∫¶„Å™„ÇØ„Ç®„É™„ÉÜ„ÇØ„Éã„ÉÉ„ÇØ</h3>
                <pre><code class="language-javascript">// Ë§áÈõë„Å™„Ç¢„Ç∞„É™„Ç≤„Éº„Ç∑„Éß„É≥
const getPopularPosts = async () => {
  const posts = await Post.aggregate([
    // ÂÖ¨ÈñãÊ∏à„Åø„ÅÆÊäïÁ®ø„ÅÆ„Åø
    { $match: { status: 'published' } },
    
    // Êó•‰ªò„Åß„Éï„Ç£„É´„ÇøÔºàÈÅéÂéª30Êó•Ôºâ
    {
      $match: {
        publishedAt: {
          $gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)
        }
      }
    },
    
    // „ÅÑ„ÅÑ„Å≠Êï∞„ÇíË®àÁÆó
    {
      $addFields: {
        likeCount: { $size: '$likes' },
        commentCount: { $size: '$comments' }
      }
    },
    
    // ‰∫∫Ê∞óÂ∫¶„Çπ„Ç≥„Ç¢„ÇíË®àÁÆó
    {
      $addFields: {
        popularityScore: {
          $add: [
            { $multiply: ['$views', 0.1] },
            { $multiply: ['$likeCount', 2] },
            { $multiply: ['$commentCount', 3] }
          ]
        }
      }
    },
    
    // „ÇΩ„Éº„Éà
    { $sort: { popularityScore: -1 } },
    
    // ‰∏ä‰Ωç10‰ª∂„ÇíÂèñÂæó
    { $limit: 10 },
    
    // ËëóËÄÖÊÉÖÂ†±„ÇíÁµêÂêà
    {
      $lookup: {
        from: 'users',
        localField: 'author',
        foreignField: '_id',
        as: 'author'
      }
    },
    
    // ÈÖçÂàó„ÇíÂçò‰∏Ä„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å´Â§âÊèõ
    { $unwind: '$author' },
    
    // ÂøÖË¶Å„Å™„Éï„Ç£„Éº„É´„Éâ„ÅÆ„ÅøÈÅ∏Êäû
    {
      $project: {
        title: 1,
        slug: 1,
        excerpt: 1,
        author: {
          name: 1,
          email: 1,
          'profile.avatar': 1
        },
        category: 1,
        tags: 1,
        views: 1,
        likeCount: 1,
        commentCount: 1,
        popularityScore: 1,
        publishedAt: 1
      }
    }
  ]);
  
  return posts;
};

// „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„ÅÆ‰ΩøÁî®
const transferPost = async (postId, fromUserId, toUserId) => {
  const session = await mongoose.startSession();
  session.startTransaction();
  
  try {
    // ÊäïÁ®ø„ÅÆËëóËÄÖ„ÇíÊõ¥Êñ∞
    const post = await Post.findByIdAndUpdate(
      postId,
      { author: toUserId },
      { session, new: true }
    );
    
    if (!post) {
      throw new Error('ÊäïÁ®ø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
    }
    
    // ÂÖÉ„ÅÆËëóËÄÖ„Åã„ÇâÊäïÁ®ø„ÇíÂâäÈô§
    await User.findByIdAndUpdate(
      fromUserId,
      { $pull: { posts: postId } },
      { session }
    );
    
    // Êñ∞„Åó„ÅÑËëóËÄÖ„Å´ÊäïÁ®ø„ÇíËøΩÂä†
    await User.findByIdAndUpdate(
      toUserId,
      { $push: { posts: postId } },
      { session }
    );
    
    // „Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥„Çí„Ç≥„Éü„ÉÉ„Éà
    await session.commitTransaction();
    session.endSession();
    
    return post;
  } catch (error) {
    // „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åü„Çâ„É≠„Éº„É´„Éê„ÉÉ„ÇØ
    await session.abortTransaction();
    session.endSession();
    throw error;
  }
};

// „Éê„É´„ÇØÊìç‰Ωú
const bulkUpdatePosts = async (updates) => {
  const bulkOps = updates.map(update => ({
    updateOne: {
      filter: { _id: update.id },
      update: { $set: update.data },
      upsert: false
    }
  }));
  
  const result = await Post.bulkWrite(bulkOps);
  return result;
};</code></pre>
            </section>

            <!-- PostgreSQL and Sequelize -->
            <section id="postgresql-sequelize" class="tutorial-section">
                <h2>PostgreSQL „Å® Sequelize</h2>
                <p>PostgreSQL„ÅØÊúÄ„ÇÇÈ´òÊ©üËÉΩ„Å™„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„ÅÆ„É™„É¨„Éº„Ç∑„Éß„Éä„É´„Éá„Éº„Çø„Éô„Éº„Çπ„Åß„ÄÅSequelize„ÅØNode.jsÁî®„ÅÆÂº∑Âäõ„Å™ORM„Åß„Åô„ÄÇ</p>

                <h3>1. „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó</h3>
                <pre><code class="language-bash"># PostgreSQL„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÔºàmacOSÔºâ
brew install postgresql
brew services start postgresql

# „Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆ‰ΩúÊàê
createdb myapp_development
createdb myapp_test
createdb myapp_production

# Sequelize„Å®ÂøÖË¶Å„Å™„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
npm install sequelize pg pg-hstore
npm install --save-dev sequelize-cli

# Sequelize„ÅÆÂàùÊúüÂåñ
npx sequelize-cli init</code></pre>

                <h3>2. Ë®≠ÂÆö„Éï„Ç°„Ç§„É´</h3>
                <p><strong>config/config.js</strong></p>
                <pre><code class="language-javascript">require('dotenv').config();

module.exports = {
  development: {
    username: process.env.DB_USERNAME || 'postgres',
    password: process.env.DB_PASSWORD || null,
    database: process.env.DB_NAME || 'myapp_development',
    host: process.env.DB_HOST || '127.0.0.1',
    port: process.env.DB_PORT || 5432,
    dialect: 'postgres',
    logging: console.log,
    pool: {
      max: 5,
      min: 0,
      acquire: 30000,
      idle: 10000
    }
  },
  test: {
    username: process.env.DB_USERNAME || 'postgres',
    password: process.env.DB_PASSWORD || null,
    database: process.env.DB_NAME_TEST || 'myapp_test',
    host: process.env.DB_HOST || '127.0.0.1',
    dialect: 'postgres',
    logging: false
  },
  production: {
    use_env_variable: 'DATABASE_URL',
    dialect: 'postgres',
    dialectOptions: {
      ssl: {
        require: true,
        rejectUnauthorized: false
      }
    },
    logging: false,
    pool: {
      max: 10,
      min: 2,
      acquire: 30000,
      idle: 10000
    }
  }
};</code></pre>

                <h3>3. „É¢„Éá„É´„ÅÆÂÆöÁæ©</h3>
                <p><strong>models/index.js</strong></p>
                <pre><code class="language-javascript">const { Sequelize } = require('sequelize');
const config = require('../config/config.js')[process.env.NODE_ENV || 'development'];

let sequelize;
if (config.use_env_variable) {
  sequelize = new Sequelize(process.env[config.use_env_variable], config);
} else {
  sequelize = new Sequelize(config.database, config.username, config.password, config);
}

// „É¢„Éá„É´„ÅÆ„Ç§„É≥„Éù„Éº„Éà
const User = require('./user')(sequelize, Sequelize.DataTypes);
const Product = require('./product')(sequelize, Sequelize.DataTypes);
const Order = require('./order')(sequelize, Sequelize.DataTypes);
const OrderItem = require('./orderItem')(sequelize, Sequelize.DataTypes);
const Category = require('./category')(sequelize, Sequelize.DataTypes);
const Review = require('./review')(sequelize, Sequelize.DataTypes);

// „Ç¢„ÇΩ„Ç∑„Ç®„Éº„Ç∑„Éß„É≥„ÅÆÂÆöÁæ©
// User associations
User.hasMany(Order, { foreignKey: 'userId', as: 'orders' });
User.hasMany(Review, { foreignKey: 'userId', as: 'reviews' });

// Product associations
Product.belongsTo(Category, { foreignKey: 'categoryId', as: 'category' });
Product.hasMany(OrderItem, { foreignKey: 'productId', as: 'orderItems' });
Product.hasMany(Review, { foreignKey: 'productId', as: 'reviews' });

// Order associations
Order.belongsTo(User, { foreignKey: 'userId', as: 'user' });
Order.hasMany(OrderItem, { foreignKey: 'orderId', as: 'items' });

// OrderItem associations
OrderItem.belongsTo(Order, { foreignKey: 'orderId' });
OrderItem.belongsTo(Product, { foreignKey: 'productId', as: 'product' });

// Category associations
Category.hasMany(Product, { foreignKey: 'categoryId', as: 'products' });

// Review associations
Review.belongsTo(User, { foreignKey: 'userId', as: 'user' });
Review.belongsTo(Product, { foreignKey: 'productId', as: 'product' });

module.exports = {
  sequelize,
  Sequelize,
  User,
  Product,
  Order,
  OrderItem,
  Category,
  Review
};</code></pre>

                <p><strong>models/user.js</strong></p>
                <pre><code class="language-javascript">const bcrypt = require('bcryptjs');

module.exports = (sequelize, DataTypes) => {
  const User = sequelize.define('User', {
    id: {
      type: DataTypes.UUID,
      defaultValue: DataTypes.UUIDV4,
      primaryKey: true
    },
    username: {
      type: DataTypes.STRING,
      allowNull: false,
      unique: true,
      validate: {
        len: [3, 30],
        isAlphanumeric: true
      }
    },
    email: {
      type: DataTypes.STRING,
      allowNull: false,
      unique: true,
      validate: {
        isEmail: true
      }
    },
    password: {
      type: DataTypes.STRING,
      allowNull: false,
      validate: {
        len: [6, 100]
      }
    },
    firstName: {
      type: DataTypes.STRING,
      allowNull: false,
      validate: {
        len: [1, 50]
      }
    },
    lastName: {
      type: DataTypes.STRING,
      allowNull: false,
      validate: {
        len: [1, 50]
      }
    },
    role: {
      type: DataTypes.ENUM('customer', 'admin', 'vendor'),
      defaultValue: 'customer'
    },
    isActive: {
      type: DataTypes.BOOLEAN,
      defaultValue: true
    },
    emailVerified: {
      type: DataTypes.BOOLEAN,
      defaultValue: false
    },
    emailVerificationToken: DataTypes.STRING,
    passwordResetToken: DataTypes.STRING,
    passwordResetExpires: DataTypes.DATE,
    lastLogin: DataTypes.DATE,
    profile: {
      type: DataTypes.JSONB,
      defaultValue: {},
      get() {
        return this.getDataValue('profile') || {};
      }
    },
    preferences: {
      type: DataTypes.JSONB,
      defaultValue: {
        notifications: {
          email: true,
          push: false
        },
        theme: 'light'
      }
    },
    address: {
      type: DataTypes.JSONB,
      defaultValue: {}
    }
  }, {
    tableName: 'users',
    timestamps: true,
    indexes: [
      {
        fields: ['email']
      },
      {
        fields: ['username']
      },
      {
        fields: ['createdAt']
      }
    ],
    hooks: {
      beforeCreate: async (user) => {
        user.password = await bcrypt.hash(user.password, 10);
      },
      beforeUpdate: async (user) => {
        if (user.changed('password')) {
          user.password = await bcrypt.hash(user.password, 10);
        }
      }
    }
  });

  // „Ç§„É≥„Çπ„Çø„É≥„Çπ„É°„ÇΩ„ÉÉ„Éâ
  User.prototype.comparePassword = async function(password) {
    return bcrypt.compare(password, this.password);
  };

  User.prototype.getFullName = function() {
    return `${this.firstName} ${this.lastName}`;
  };

  User.prototype.toJSON = function() {
    const values = Object.assign({}, this.get());
    delete values.password;
    delete values.emailVerificationToken;
    delete values.passwordResetToken;
    delete values.passwordResetExpires;
    return values;
  };

  // „ÇØ„É©„Çπ„É°„ÇΩ„ÉÉ„Éâ
  User.findByEmail = function(email) {
    return this.findOne({ where: { email } });
  };

  User.findActiveUsers = function() {
    return this.findAll({ 
      where: { isActive: true },
      order: [['createdAt', 'DESC']]
    });
  };

  return User;
};</code></pre>

                <p><strong>models/product.js</strong></p>
                <pre><code class="language-javascript">module.exports = (sequelize, DataTypes) => {
  const Product = sequelize.define('Product', {
    id: {
      type: DataTypes.UUID,
      defaultValue: DataTypes.UUIDV4,
      primaryKey: true
    },
    name: {
      type: DataTypes.STRING,
      allowNull: false,
      validate: {
        len: [1, 200]
      }
    },
    slug: {
      type: DataTypes.STRING,
      unique: true
    },
    description: {
      type: DataTypes.TEXT,
      allowNull: false
    },
    price: {
      type: DataTypes.DECIMAL(10, 2),
      allowNull: false,
      validate: {
        min: 0
      }
    },
    compareAtPrice: {
      type: DataTypes.DECIMAL(10, 2),
      validate: {
        min: 0
      }
    },
    cost: {
      type: DataTypes.DECIMAL(10, 2),
      validate: {
        min: 0
      }
    },
    sku: {
      type: DataTypes.STRING,
      unique: true
    },
    barcode: DataTypes.STRING,
    trackQuantity: {
      type: DataTypes.BOOLEAN,
      defaultValue: true
    },
    quantity: {
      type: DataTypes.INTEGER,
      defaultValue: 0,
      validate: {
        min: 0
      }
    },
    weight: {
      type: DataTypes.DECIMAL(10, 2),
      validate: {
        min: 0
      }
    },
    weightUnit: {
      type: DataTypes.ENUM('kg', 'g', 'lb', 'oz'),
      defaultValue: 'kg'
    },
    status: {
      type: DataTypes.ENUM('active', 'draft', 'archived'),
      defaultValue: 'active'
    },
    images: {
      type: DataTypes.JSONB,
      defaultValue: []
    },
    tags: {
      type: DataTypes.ARRAY(DataTypes.STRING),
      defaultValue: []
    },
    metadata: {
      type: DataTypes.JSONB,
      defaultValue: {}
    },
    categoryId: {
      type: DataTypes.UUID,
      references: {
        model: 'categories',
        key: 'id'
      }
    }
  }, {
    tableName: 'products',
    timestamps: true,
    paranoid: true,
    indexes: [
      {
        fields: ['slug']
      },
      {
        fields: ['sku']
      },
      {
        fields: ['status']
      },
      {
        fields: ['categoryId']
      },
      {
        type: 'FULLTEXT',
        fields: ['name', 'description']
      }
    ],
    hooks: {
      beforeCreate: (product) => {
        if (!product.slug) {
          product.slug = product.name
            .toLowerCase()
            .replace(/[^\w\s-]/g, '')
            .replace(/\s+/g, '-')
            .replace(/-+/g, '-')
            .trim();
        }
      }
    }
  });

  // „Çπ„Ç≥„Éº„Éó
  Product.addScope('active', {
    where: { status: 'active' }
  });

  Product.addScope('inStock', {
    where: {
      [sequelize.Sequelize.Op.or]: [
        { trackQuantity: false },
        { quantity: { [sequelize.Sequelize.Op.gt]: 0 } }
      ]
    }
  });

  Product.addScope('withCategory', {
    include: [{
      model: sequelize.models.Category,
      as: 'category'
    }]
  });

  // „Ç§„É≥„Çπ„Çø„É≥„Çπ„É°„ÇΩ„ÉÉ„Éâ
  Product.prototype.isInStock = function() {
    return !this.trackQuantity || this.quantity > 0;
  };

  Product.prototype.updateStock = async function(quantity, operation = 'decrease') {
    if (!this.trackQuantity) return this;
    
    if (operation === 'decrease') {
      if (this.quantity < quantity) {
        throw new Error('Âú®Â∫´„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„Åô');
      }
      this.quantity -= quantity;
    } else {
      this.quantity += quantity;
    }
    
    return this.save();
  };

  return Product;
};</code></pre>

                <h3>4. „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥</h3>
                <p><strong>migrations/20240101000001-create-users-table.js</strong></p>
                <pre><code class="language-javascript">module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.createTable('users', {
      id: {
        type: Sequelize.UUID,
        defaultValue: Sequelize.UUIDV4,
        primaryKey: true,
        allowNull: false
      },
      username: {
        type: Sequelize.STRING,
        allowNull: false,
        unique: true
      },
      email: {
        type: Sequelize.STRING,
        allowNull: false,
        unique: true
      },
      password: {
        type: Sequelize.STRING,
        allowNull: false
      },
      firstName: {
        type: Sequelize.STRING,
        allowNull: false
      },
      lastName: {
        type: Sequelize.STRING,
        allowNull: false
      },
      role: {
        type: Sequelize.ENUM('customer', 'admin', 'vendor'),
        defaultValue: 'customer'
      },
      isActive: {
        type: Sequelize.BOOLEAN,
        defaultValue: true
      },
      emailVerified: {
        type: Sequelize.BOOLEAN,
        defaultValue: false
      },
      emailVerificationToken: Sequelize.STRING,
      passwordResetToken: Sequelize.STRING,
      passwordResetExpires: Sequelize.DATE,
      lastLogin: Sequelize.DATE,
      profile: {
        type: Sequelize.JSONB,
        defaultValue: {}
      },
      preferences: {
        type: Sequelize.JSONB,
        defaultValue: {}
      },
      address: {
        type: Sequelize.JSONB,
        defaultValue: {}
      },
      createdAt: {
        type: Sequelize.DATE,
        allowNull: false
      },
      updatedAt: {
        type: Sequelize.DATE,
        allowNull: false
      }
    });

    // „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆËøΩÂä†
    await queryInterface.addIndex('users', ['email']);
    await queryInterface.addIndex('users', ['username']);
    await queryInterface.addIndex('users', ['createdAt']);
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.dropTable('users');
  }
};</code></pre>

                <h3>5. È´òÂ∫¶„Å™„ÇØ„Ç®„É™„Å®„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥</h3>
                <p><strong>controllers/productController.js</strong></p>
                <pre><code class="language-javascript">const { Product, Category, Review, OrderItem, sequelize } = require('../models');
const { Op } = require('sequelize');

// ÂïÜÂìÅÊ§úÁ¥¢Ôºà„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„ÄÅ„ÇΩ„Éº„Éà„ÄÅ„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥Ôºâ
exports.searchProducts = async (req, res) => {
  try {
    const {
      q,
      category,
      minPrice,
      maxPrice,
      tags,
      inStock,
      sortBy = 'createdAt',
      order = 'DESC',
      page = 1,
      limit = 20
    } = req.query;

    // WHEREÂè•„ÅÆÊßãÁØâ
    const where = {};
    
    // „ÉÜ„Ç≠„Çπ„ÉàÊ§úÁ¥¢
    if (q) {
      where[Op.or] = [
        { name: { [Op.iLike]: `%${q}%` } },
        { description: { [Op.iLike]: `%${q}%` } }
      ];
    }
    
    // ‰æ°Ê†º„Éï„Ç£„É´„Çø„Éº
    if (minPrice || maxPrice) {
      where.price = {};
      if (minPrice) where.price[Op.gte] = minPrice;
      if (maxPrice) where.price[Op.lte] = maxPrice;
    }
    
    // „Çø„Ç∞„Éï„Ç£„É´„Çø„Éº
    if (tags) {
      const tagArray = Array.isArray(tags) ? tags : tags.split(',');
      where.tags = { [Op.contains]: tagArray };
    }
    
    // Âú®Â∫´„Éï„Ç£„É´„Çø„Éº
    if (inStock === 'true') {
      where[Op.or] = [
        { trackQuantity: false },
        { quantity: { [Op.gt]: 0 } }
      ];
    }
    
    // „Çπ„ÉÜ„Éº„Çø„Çπ„ÅØÂ∏∏„Å´active„ÅÆ„Åø
    where.status = 'active';

    // „Ç´„ÉÜ„Ç¥„É™„Éº„Éï„Ç£„É´„Çø„Éº
    const include = [{
      model: Category,
      as: 'category',
      where: category ? { slug: category } : undefined,
      required: !!category
    }];

    // „ÇØ„Ç®„É™ÂÆüË°å
    const products = await Product.findAndCountAll({
      where,
      include,
      order: [[sortBy, order]],
      limit: parseInt(limit),
      offset: (parseInt(page) - 1) * parseInt(limit),
      distinct: true,
      subQuery: false
    });

    // „É¨„Çπ„Éù„É≥„Çπ
    res.json({
      success: true,
      data: products.rows,
      pagination: {
        total: products.count,
        page: parseInt(page),
        pages: Math.ceil(products.count / parseInt(limit)),
        limit: parseInt(limit)
      }
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
};

// ÂïÜÂìÅË©≥Á¥∞„Å®Èñ¢ÈÄ£ÊÉÖÂ†±„ÅÆÂèñÂæó
exports.getProductDetail = async (req, res) => {
  try {
    const product = await Product.findOne({
      where: { slug: req.params.slug },
      include: [
        {
          model: Category,
          as: 'category',
          attributes: ['id', 'name', 'slug']
        },
        {
          model: Review,
          as: 'reviews',
          attributes: ['id', 'rating', 'comment', 'createdAt'],
          include: [{
            model: User,
            as: 'user',
            attributes: ['id', 'firstName', 'lastName']
          }],
          limit: 10,
          order: [['createdAt', 'DESC']]
        }
      ]
    });

    if (!product) {
      return res.status(404).json({
        success: false,
        error: 'ÂïÜÂìÅ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì'
      });
    }

    // Èñ¢ÈÄ£ÂïÜÂìÅ„ÅÆÂèñÂæó
    const relatedProducts = await Product.findAll({
      where: {
        categoryId: product.categoryId,
        id: { [Op.ne]: product.id },
        status: 'active'
      },
      limit: 4,
      order: sequelize.random()
    });

    // Â£≤‰∏äÁµ±Ë®à
    const salesStats = await OrderItem.findOne({
      where: { productId: product.id },
      attributes: [
        [sequelize.fn('COUNT', sequelize.col('id')), 'totalOrders'],
        [sequelize.fn('SUM', sequelize.col('quantity')), 'totalSold'],
        [sequelize.fn('AVG', sequelize.col('price')), 'avgPrice']
      ],
      raw: true
    });

    res.json({
      success: true,
      data: {
        product,
        relatedProducts,
        salesStats
      }
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
};

// Âú®Â∫´„ÅÆ‰∏ÄÊã¨Êõ¥Êñ∞Ôºà„Éà„É©„É≥„Ç∂„ÇØ„Ç∑„Éß„É≥‰ΩøÁî®Ôºâ
exports.bulkUpdateStock = async (req, res) => {
  const t = await sequelize.transaction();
  
  try {
    const updates = req.body.updates; // [{ productId, quantity, operation }]
    
    for (const update of updates) {
      const product = await Product.findByPk(update.productId, {
        transaction: t,
        lock: t.LOCK.UPDATE
      });
      
      if (!product) {
        throw new Error(`ÂïÜÂìÅID ${update.productId} „ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì`);
      }
      
      if (update.operation === 'set') {
        product.quantity = update.quantity;
      } else if (update.operation === 'increase') {
        product.quantity += update.quantity;
      } else if (update.operation === 'decrease') {
        if (product.quantity < update.quantity) {
          throw new Error(`ÂïÜÂìÅ ${product.name} „ÅÆÂú®Â∫´„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„Åô`);
        }
        product.quantity -= update.quantity;
      }
      
      await product.save({ transaction: t });
    }
    
    await t.commit();
    
    res.json({
      success: true,
      message: 'Âú®Â∫´„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü'
    });
  } catch (error) {
    await t.rollback();
    res.status(400).json({
      success: false,
      error: error.message
    });
  }
};

// Â£≤‰∏ä„É¨„Éù„Éº„ÉàÔºàÈõÜË®à„ÇØ„Ç®„É™Ôºâ
exports.getSalesReport = async (req, res) => {
  try {
    const { startDate, endDate, groupBy = 'day' } = req.query;
    
    // Êó•‰ªò„Éï„Ç©„Éº„Éû„ÉÉ„Éà
    let dateFormat;
    switch (groupBy) {
      case 'day':
        dateFormat = 'YYYY-MM-DD';
        break;
      case 'week':
        dateFormat = 'IYYY-IW';
        break;
      case 'month':
        dateFormat = 'YYYY-MM';
        break;
      default:
        dateFormat = 'YYYY-MM-DD';
    }
    
    const salesData = await OrderItem.findAll({
      attributes: [
        [sequelize.fn('DATE_TRUNC', groupBy, sequelize.col('OrderItem.createdAt')), 'period'],
        [sequelize.fn('COUNT', sequelize.col('OrderItem.id')), 'orderCount'],
        [sequelize.fn('SUM', sequelize.col('quantity')), 'totalQuantity'],
        [sequelize.fn('SUM', sequelize.literal('quantity * price')), 'totalRevenue']
      ],
      include: [{
        model: Product,
        as: 'product',
        attributes: []
      }],
      where: {
        createdAt: {
          [Op.between]: [startDate || '2020-01-01', endDate || new Date()]
        }
      },
      group: ['period'],
      order: [['period', 'ASC']],
      raw: true
    });
    
    // „Ç´„ÉÜ„Ç¥„É™„ÉºÂà•Â£≤‰∏ä
    const categoryData = await OrderItem.findAll({
      attributes: [
        [sequelize.col('product.category.name'), 'categoryName'],
        [sequelize.fn('SUM', sequelize.col('quantity')), 'totalQuantity'],
        [sequelize.fn('SUM', sequelize.literal('OrderItem.quantity * OrderItem.price')), 'totalRevenue']
      ],
      include: [{
        model: Product,
        as: 'product',
        attributes: [],
        include: [{
          model: Category,
          as: 'category',
          attributes: []
        }]
      }],
      where: {
        createdAt: {
          [Op.between]: [startDate || '2020-01-01', endDate || new Date()]
        }
      },
      group: ['product.category.id', 'product.category.name'],
      order: [[sequelize.literal('totalRevenue'), 'DESC']],
      raw: true
    });
    
    res.json({
      success: true,
      data: {
        salesData,
        categoryData
      }
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
};</code></pre>
            </section>

            <!-- Redis Caching -->
            <section id="redis-caching" class="tutorial-section">
                <h2>Redis „Åß„Ç≠„É£„ÉÉ„Ç∑„É≥„Ç∞</h2>
                <p>Redis„ÅØÈ´òÈÄü„Å™„Ç§„É≥„É°„É¢„É™„Éá„Éº„Çø„Çπ„Éà„Ç¢„Åß„ÄÅ„Ç≠„É£„ÉÉ„Ç∑„É≥„Ç∞„ÄÅ„Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ„ÄÅ„É™„Ç¢„É´„Çø„Ç§„É†Ê©üËÉΩ„ÅÆÂÆüË£Ö„Å´ÊúÄÈÅ©„Åß„Åô„ÄÇ</p>

                <h3>1. „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó</h3>
                <pre><code class="language-bash"># Redis„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÔºàmacOSÔºâ
brew install redis
brew services start redis

# Node.js„ÇØ„É©„Ç§„Ç¢„É≥„Éà„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
npm install redis ioredis</code></pre>

                <h3>2. RedisÊé•Á∂ö„ÅÆË®≠ÂÆö</h3>
                <p><strong>config/redis.js</strong></p>
                <pre><code class="language-javascript">const Redis = require('ioredis');

// RedisÊé•Á∂ö„ÅÆ‰ΩúÊàê
const redis = new Redis({
  host: process.env.REDIS_HOST || 'localhost',
  port: process.env.REDIS_PORT || 6379,
  password: process.env.REDIS_PASSWORD,
  db: process.env.REDIS_DB || 0,
  retryStrategy: (times) => {
    const delay = Math.min(times * 50, 2000);
    return delay;
  },
  maxRetriesPerRequest: 3
});

// Êé•Á∂ö„Ç§„Éô„É≥„Éà
redis.on('connect', () => {
  console.log('Redis connected');
});

redis.on('error', (err) => {
  console.error('Redis error:', err);
});

// Pub/SubÁî®„ÅÆÂà•Êé•Á∂ö
const pubClient = redis.duplicate();
const subClient = redis.duplicate();

module.exports = {
  redis,
  pubClient,
  subClient
};</code></pre>

                <h3>3. „Ç≠„É£„ÉÉ„Ç∑„É≥„Ç∞„Éü„Éâ„É´„Ç¶„Çß„Ç¢</h3>
                <p><strong>middleware/cache.js</strong></p>
                <pre><code class="language-javascript">const { redis } = require('../config/redis');

// „Ç≠„É£„ÉÉ„Ç∑„É•„Ç≠„Éº„ÅÆÁîüÊàê
const generateCacheKey = (req) => {
  const { originalUrl, method } = req;
  const userId = req.user?.id || 'anonymous';
  return `cache:${method}:${originalUrl}:${userId}`;
};

// „Ç≠„É£„ÉÉ„Ç∑„É•„Éü„Éâ„É´„Ç¶„Çß„Ç¢
const cache = (duration = 300) => {
  return async (req, res, next) => {
    // POST„É™„ÇØ„Ç®„Çπ„Éà„ÅØ„Ç≠„É£„ÉÉ„Ç∑„É•„Åó„Å™„ÅÑ
    if (req.method !== 'GET') {
      return next();
    }
    
    const key = generateCacheKey(req);
    
    try {
      const cachedData = await redis.get(key);
      
      if (cachedData) {
        const data = JSON.parse(cachedData);
        console.log('Cache hit:', key);
        return res.json(data);
      }
      
      // „Ç≠„É£„ÉÉ„Ç∑„É•„Åå„Å™„ÅÑÂ†¥Âêà„ÅØÊ¨°„Å∏
      console.log('Cache miss:', key);
      
      // „É¨„Çπ„Éù„É≥„Çπ„Çí„Ç§„É≥„Çø„Éº„Çª„Éó„Éà
      const originalJson = res.json;
      res.json = function(data) {
        // „É¨„Çπ„Éù„É≥„Çπ„Çí„Ç≠„É£„ÉÉ„Ç∑„É•„Å´‰øùÂ≠ò
        redis.setex(key, duration, JSON.stringify(data))
          .catch(err => console.error('Cache set error:', err));
        
        // ÂÖÉ„ÅÆjson„É°„ÇΩ„ÉÉ„Éâ„ÇíÂëº„Å∂
        originalJson.call(this, data);
      };
      
      next();
    } catch (error) {
      console.error('Cache middleware error:', error);
      next();
    }
  };
};

// „Ç≠„É£„ÉÉ„Ç∑„É•„ÅÆÁÑ°ÂäπÂåñ
const invalidateCache = (pattern) => {
  return async (req, res, next) => {
    try {
      const keys = await redis.keys(`cache:*${pattern}*`);
      if (keys.length > 0) {
        await redis.del(keys);
        console.log(`Invalidated ${keys.length} cache keys`);
      }
      next();
    } catch (error) {
      console.error('Cache invalidation error:', error);
      next();
    }
  };
};

// „Çø„Ç∞„Éô„Éº„Çπ„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•
class TaggedCache {
  constructor(redis) {
    this.redis = redis;
  }
  
  async set(key, value, tags = [], ttl = 300) {
    const pipeline = this.redis.pipeline();
    
    // „Éá„Éº„Çø„Çí‰øùÂ≠ò
    pipeline.setex(key, ttl, JSON.stringify(value));
    
    // „Çø„Ç∞„Å®„Ç≠„Éº„ÅÆÈñ¢ÈÄ£‰ªò„Åë
    for (const tag of tags) {
      pipeline.sadd(`tag:${tag}`, key);
      pipeline.expire(`tag:${tag}`, ttl);
    }
    
    await pipeline.exec();
  }
  
  async get(key) {
    const data = await this.redis.get(key);
    return data ? JSON.parse(data) : null;
  }
  
  async invalidateTag(tag) {
    const keys = await this.redis.smembers(`tag:${tag}`);
    
    if (keys.length > 0) {
      const pipeline = this.redis.pipeline();
      
      // „Ç≠„Éº„ÇíÂâäÈô§
      for (const key of keys) {
        pipeline.del(key);
      }
      
      // „Çø„Ç∞„Çª„ÉÉ„Éà„ÇíÂâäÈô§
      pipeline.del(`tag:${tag}`);
      
      await pipeline.exec();
      console.log(`Invalidated ${keys.length} keys for tag: ${tag}`);
    }
  }
}

const taggedCache = new TaggedCache(redis);

module.exports = {
  cache,
  invalidateCache,
  taggedCache
};</code></pre>

                <h3>4. „Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ</h3>
                <p><strong>config/session.js</strong></p>
                <pre><code class="language-javascript">const session = require('express-session');
const RedisStore = require('connect-redis')(session);
const { redis } = require('./redis');

const sessionConfig = {
  store: new RedisStore({
    client: redis,
    prefix: 'sess:',
  }),
  secret: process.env.SESSION_SECRET || 'your-secret-key',
  resave: false,
  saveUninitialized: false,
  cookie: {
    secure: process.env.NODE_ENV === 'production',
    httpOnly: true,
    maxAge: 1000 * 60 * 60 * 24 * 7, // 1ÈÄ±Èñì
    sameSite: 'lax'
  },
  name: 'sessionId'
};

module.exports = sessionConfig;</code></pre>

                <h3>5. „É¨„Éº„ÉàÂà∂Èôê</h3>
                <p><strong>middleware/rateLimiter.js</strong></p>
                <pre><code class="language-javascript">const { redis } = require('../config/redis');

// „Çπ„É©„Ç§„Éá„Ç£„É≥„Ç∞„Ç¶„Ç£„É≥„Éâ„Ç¶ÊñπÂºè„ÅÆ„É¨„Éº„ÉàÂà∂Èôê
const rateLimiter = (options = {}) => {
  const {
    windowMs = 60000, // 1ÂàÜ
    max = 100, // ÊúÄÂ§ß„É™„ÇØ„Ç®„Çπ„ÉàÊï∞
    keyGenerator = (req) => req.ip,
    skipSuccessfulRequests = false,
    skipFailedRequests = false,
    message = '„É™„ÇØ„Ç®„Çπ„Éà„ÅåÂ§ö„Åô„Åé„Åæ„Åô„ÄÇ„Åó„Å∞„Çâ„ÅèÂæÖ„Å£„Å¶„Åã„ÇâÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
  } = options;
  
  return async (req, res, next) => {
    const key = `rate:${keyGenerator(req)}`;
    const now = Date.now();
    const windowStart = now - windowMs;
    
    try {
      const pipeline = redis.pipeline();
      
      // Âè§„ÅÑ„Ç®„É≥„Éà„É™„ÇíÂâäÈô§
      pipeline.zremrangebyscore(key, '-inf', windowStart);
      
      // ÁèæÂú®„ÅÆ„É™„ÇØ„Ç®„Çπ„ÉàÊï∞„ÇíÂèñÂæó
      pipeline.zcard(key);
      
      // Êñ∞„Åó„ÅÑ„É™„ÇØ„Ç®„Çπ„Éà„ÇíËøΩÂä†
      pipeline.zadd(key, now, `${now}-${Math.random()}`);
      
      // TTL„ÇíË®≠ÂÆö
      pipeline.expire(key, Math.ceil(windowMs / 1000));
      
      const results = await pipeline.exec();
      const requestCount = results[1][1];
      
      // „É¨„Éº„ÉàÂà∂Èôê„ÉÅ„Çß„ÉÉ„ÇØ
      if (requestCount >= max) {
        res.setHeader('X-RateLimit-Limit', max);
        res.setHeader('X-RateLimit-Remaining', 0);
        res.setHeader('X-RateLimit-Reset', new Date(now + windowMs).toISOString());
        
        return res.status(429).json({
          error: message,
          retryAfter: Math.ceil(windowMs / 1000)
        });
      }
      
      // „Éò„ÉÉ„ÉÄ„Éº„ÇíË®≠ÂÆö
      res.setHeader('X-RateLimit-Limit', max);
      res.setHeader('X-RateLimit-Remaining', max - requestCount - 1);
      res.setHeader('X-RateLimit-Reset', new Date(now + windowMs).toISOString());
      
      // „É™„ÇØ„Ç®„Çπ„ÉàÂÆå‰∫ÜÂæå„ÅÆÂá¶ÁêÜ
      res.on('finish', () => {
        if (
          (skipSuccessfulRequests && res.statusCode < 400) ||
          (skipFailedRequests && res.statusCode >= 400)
        ) {
          // „É™„ÇØ„Ç®„Çπ„Éà„Çí„Ç´„Ç¶„É≥„Éà„Åã„ÇâÂâäÈô§
          redis.zrem(key, `${now}-${Math.random()}`);
        }
      });
      
      next();
    } catch (error) {
      console.error('Rate limiter error:', error);
      next(); // „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Å¶„ÇÇ„É™„ÇØ„Ç®„Çπ„Éà„ÇíÈÄö„Åô
    }
  };
};

// APIÂà•„ÅÆ„É¨„Éº„ÉàÂà∂Èôê
const apiLimiter = rateLimiter({
  windowMs: 15 * 60 * 1000, // 15ÂàÜ
  max: 100,
  keyGenerator: (req) => `api:${req.ip}:${req.user?.id || 'anonymous'}`
});

// Ë™çË®º„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà„ÅÆ„É¨„Éº„ÉàÂà∂Èôê
const authLimiter = rateLimiter({
  windowMs: 15 * 60 * 1000, // 15ÂàÜ
  max: 5,
  keyGenerator: (req) => `auth:${req.ip}`,
  skipSuccessfulRequests: true
});

module.exports = {
  rateLimiter,
  apiLimiter,
  authLimiter
};</code></pre>

                <h3>6. „É™„Ç¢„É´„Çø„Ç§„É†Ê©üËÉΩÔºàPub/SubÔºâ</h3>
                <p><strong>services/realtime.js</strong></p>
                <pre><code class="language-javascript">const { pubClient, subClient } = require('../config/redis');
const EventEmitter = require('events');

class RealtimeService extends EventEmitter {
  constructor() {
    super();
    this.channels = new Map();
    this.setupSubscriber();
  }
  
  setupSubscriber() {
    subClient.on('message', (channel, message) => {
      try {
        const data = JSON.parse(message);
        this.emit(channel, data);
        
        // „ÉÅ„É£„É≥„Éç„É´Âõ∫Êúâ„ÅÆ„É™„Çπ„Éä„Éº„Å´ÈÄöÁü•
        const listeners = this.channels.get(channel) || [];
        listeners.forEach(listener => listener(data));
      } catch (error) {
        console.error('Message parse error:', error);
      }
    });
  }
  
  // „ÉÅ„É£„É≥„Éç„É´„ÅÆË≥ºË™≠
  async subscribe(channel, callback) {
    if (!this.channels.has(channel)) {
      this.channels.set(channel, []);
      await subClient.subscribe(channel);
    }
    
    this.channels.get(channel).push(callback);
    
    // „Ç¢„É≥„Çµ„Éñ„Çπ„ÇØ„É©„Ç§„ÉñÈñ¢Êï∞„ÇíËøî„Åô
    return () => {
      const listeners = this.channels.get(channel);
      const index = listeners.indexOf(callback);
      if (index > -1) {
        listeners.splice(index, 1);
        
        // „É™„Çπ„Éä„Éº„Åå„Å™„Åè„Å™„Å£„Åü„Çâ„Ç¢„É≥„Çµ„Éñ„Çπ„ÇØ„É©„Ç§„Éñ
        if (listeners.length === 0) {
          this.channels.delete(channel);
          subClient.unsubscribe(channel);
        }
      }
    };
  }
  
  // „É°„ÉÉ„Çª„Éº„Ç∏„ÅÆÁô∫Ë°å
  async publish(channel, data) {
    await pubClient.publish(channel, JSON.stringify(data));
  }
  
  // „É¶„Éº„Ç∂„ÉºÈÄöÁü•
  async notifyUser(userId, notification) {
    await this.publish(`user:${userId}`, {
      type: 'notification',
      data: notification,
      timestamp: new Date()
    });
  }
  
  // „Éñ„É≠„Éº„Éâ„Ç≠„É£„Çπ„Éà
  async broadcast(event, data) {
    await this.publish('broadcast', {
      event,
      data,
      timestamp: new Date()
    });
  }
}

const realtimeService = new RealtimeService();

// WebSocket„Å®„ÅÆÁµ±Âêà‰æã
const setupWebSocket = (io) => {
  io.on('connection', (socket) => {
    console.log('Client connected:', socket.id);
    
    // „É¶„Éº„Ç∂„ÉºÂõ∫Êúâ„ÅÆ„ÉÅ„É£„É≥„Éç„É´„ÇíË≥ºË™≠
    socket.on('authenticate', async (userId) => {
      socket.userId = userId;
      
      // „É¶„Éº„Ç∂„Éº„ÉÅ„É£„É≥„Éç„É´„ÇíË≥ºË™≠
      const unsubscribe = await realtimeService.subscribe(
        `user:${userId}`,
        (data) => {
          socket.emit('message', data);
        }
      );
      
      // ÂàáÊñ≠ÊôÇ„Å´„Ç¢„É≥„Çµ„Éñ„Çπ„ÇØ„É©„Ç§„Éñ
      socket.on('disconnect', () => {
        unsubscribe();
      });
    });
    
    // „É´„Éº„É†„Å∏„ÅÆÂèÇÂä†
    socket.on('join-room', async (roomId) => {
      socket.join(roomId);
      
      const unsubscribe = await realtimeService.subscribe(
        `room:${roomId}`,
        (data) => {
          io.to(roomId).emit('room-message', data);
        }
      );
      
      socket.on('leave-room', () => {
        socket.leave(roomId);
        unsubscribe();
      });
    });
  });
};

module.exports = {
  realtimeService,
  setupWebSocket
};</code></pre>

                <h3>7. „Ç≠„É•„Éº„Ç∑„Çπ„ÉÜ„É†</h3>
                <p><strong>services/queue.js</strong></p>
                <pre><code class="language-javascript">const Bull = require('bull');
const { redis } = require('../config/redis');

// „Ç≠„É•„Éº„ÅÆ‰ΩúÊàê
const emailQueue = new Bull('email', {
  redis: {
    host: redis.options.host,
    port: redis.options.port,
    password: redis.options.password
  }
});

const imageQueue = new Bull('image-processing', {
  redis: {
    host: redis.options.host,
    port: redis.options.port,
    password: redis.options.password
  }
});

// „É°„Éº„É´ÈÄÅ‰ø°„Ç∏„Éß„Éñ„ÅÆÂá¶ÁêÜ
emailQueue.process(async (job) => {
  const { to, subject, template, data } = job.data;
  
  console.log(`Sending email to ${to}`);
  
  // „É°„Éº„É´ÈÄÅ‰ø°„É≠„Ç∏„ÉÉ„ÇØ
  await sendEmail(to, subject, template, data);
  
  return { sent: true, timestamp: new Date() };
});

// ÁîªÂÉèÂá¶ÁêÜ„Ç∏„Éß„Éñ
imageQueue.process(async (job) => {
  const { imagePath, sizes } = job.data;
  
  console.log(`Processing image: ${imagePath}`);
  
  // ÁîªÂÉè„É™„Çµ„Ç§„Ç∫„É≠„Ç∏„ÉÉ„ÇØ
  const results = await resizeImage(imagePath, sizes);
  
  return results;
});

// „Ç∏„Éß„Éñ„ÅÆËøΩÂä†
const addEmailJob = async (emailData) => {
  const job = await emailQueue.add(emailData, {
    attempts: 3,
    backoff: {
      type: 'exponential',
      delay: 2000
    }
  });
  
  return job.id;
};

const addImageJob = async (imageData) => {
  const job = await imageQueue.add(imageData, {
    priority: imageData.priority || 0,
    delay: imageData.delay || 0
  });
  
  return job.id;
};

// „Ç∏„Éß„Éñ„Ç§„Éô„É≥„Éà„ÅÆÁõ£Ë¶ñ
emailQueue.on('completed', (job, result) => {
  console.log(`Email job ${job.id} completed:`, result);
});

emailQueue.on('failed', (job, err) => {
  console.error(`Email job ${job.id} failed:`, err);
});

module.exports = {
  emailQueue,
  imageQueue,
  addEmailJob,
  addImageJob
};</code></pre>
            </section>

            <!-- ORM and Query Optimization -->
            <section id="orm-optimization" class="tutorial-section">
                <h2>ORM„Å®„ÇØ„Ç®„É™ÊúÄÈÅ©Âåñ</h2>
                <p>ORM„ÇíÂäπÁéáÁöÑ„Å´‰ΩøÁî®„Åó„ÄÅ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇíÊúÄÈÅ©Âåñ„Åô„Çã„Åü„ÇÅ„ÅÆ„ÉÜ„ÇØ„Éã„ÉÉ„ÇØ„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>

                <h3>1. N+1ÂïèÈ°å„ÅÆËß£Ê±∫</h3>
                <pre><code class="language-javascript">// ÊÇ™„ÅÑ‰æãÔºöN+1ÂïèÈ°å„ÅåÁô∫Áîü
const posts = await Post.findAll();
for (const post of posts) {
  post.author = await User.findByPk(post.authorId); // NÂõû„ÅÆ„ÇØ„Ç®„É™
}

// ËâØ„ÅÑ‰æãÔºöEager Loading
const posts = await Post.findAll({
  include: [{
    model: User,
    as: 'author',
    attributes: ['id', 'name', 'email'] // ÂøÖË¶Å„Å™„Éï„Ç£„Éº„É´„Éâ„ÅÆ„Åø
  }]
});

// „Åï„Çâ„Å´ÊúÄÈÅ©ÂåñÔºö„Éç„Çπ„Éà„Åó„ÅüÈñ¢ÈÄ£„ÅÆË™≠„ÅøËæº„Åø
const posts = await Post.findAll({
  include: [
    {
      model: User,
      as: 'author',
      attributes: ['id', 'name'],
      include: [{
        model: Profile,
        as: 'profile',
        attributes: ['avatar', 'bio']
      }]
    },
    {
      model: Comment,
      as: 'comments',
      limit: 5,
      order: [['createdAt', 'DESC']],
      include: [{
        model: User,
        as: 'user',
        attributes: ['id', 'name']
      }]
    }
  ]
});</code></pre>

                <h3>2. „ÇØ„Ç®„É™„ÅÆÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-javascript">// „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆÊ¥ªÁî®
// Mongoose„ÅÆÂ†¥Âêà
userSchema.index({ email: 1 });
userSchema.index({ createdAt: -1 });
userSchema.index({ 'profile.location': '2dsphere' }); // Âú∞ÁêÜÁ©∫Èñì„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ

// Sequelize„ÅÆÂ†¥Âêà
User.init({
  // ... fields
}, {
  indexes: [
    {
      unique: true,
      fields: ['email']
    },
    {
      fields: ['createdAt']
    },
    {
      type: 'FULLTEXT',
      fields: ['bio']
    }
  ]
});

// ÈÉ®ÂàÜ„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÔºàÊù°‰ª∂‰ªò„Åç„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÔºâ
Product.init({
  // ... fields
}, {
  indexes: [
    {
      fields: ['status', 'categoryId'],
      where: {
        status: 'active'
      }
    }
  ]
});

// Ë§áÂêà„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆÈ†ÜÂ∫è„ÇíËÄÉÊÖÆ
// ËâØ„ÅÑ‰æãÔºö„Çà„ÇäÈÅ∏ÊäûÁöÑ„Å™„Éï„Ç£„Éº„É´„Éâ„ÇíÂÖà„Å´
orderSchema.index({ status: 1, userId: 1, createdAt: -1 });

// „Éó„É≠„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥„ÅßÂøÖË¶Å„Å™„Éï„Ç£„Éº„É´„Éâ„ÅÆ„ÅøÂèñÂæó
const users = await User.find({}, 'name email createdAt');

// Lean()„ÅßËªΩÈáè„Å™„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÂèñÂæóÔºàMongooseÔºâ
const products = await Product
  .find({ status: 'active' })
  .select('name price')
  .lean(); // Mongoose„Éâ„Ç≠„É•„É°„É≥„Éà„Åß„ÅØ„Å™„Åè„ÄÅ„Éó„É¨„Éº„É≥„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíËøî„Åô</code></pre>

                <h3>3. „Éê„ÉÉ„ÉÅÂá¶ÁêÜ„Å®„Çπ„Éà„É™„Éº„Éü„É≥„Ç∞</h3>
                <pre><code class="language-javascript">// „Ç´„Éº„ÇΩ„É´„Çí‰Ωø„Å£„ÅüÂ§ßÈáè„Éá„Éº„Çø„ÅÆÂá¶ÁêÜÔºàMongoDBÔºâ
async function processLargeDataset() {
  const cursor = User.find({ isActive: true }).cursor();
  
  for (let user = await cursor.next(); user != null; user = await cursor.next()) {
    // ÂêÑ„É¶„Éº„Ç∂„Éº„ÇíÂÄãÂà•„Å´Âá¶ÁêÜ
    await processUser(user);
  }
}

// „Çπ„Éà„É™„Éº„Éü„É≥„Ç∞ÔºàPostgreSQLÔºâ
const { QueryTypes } = require('sequelize');
const stream = await sequelize.query(
  'SELECT * FROM products WHERE status = :status',
  {
    replacements: { status: 'active' },
    type: QueryTypes.SELECT,
    raw: true,
    stream: true
  }
);

stream.on('data', (product) => {
  // ÂêÑÂïÜÂìÅ„ÇíÂá¶ÁêÜ
  processProduct(product);
});

// „Éê„ÉÉ„ÉÅÂá¶ÁêÜ
async function batchProcess(model, batchSize = 1000) {
  let offset = 0;
  let hasMore = true;
  
  while (hasMore) {
    const batch = await model.findAll({
      limit: batchSize,
      offset: offset,
      raw: true
    });
    
    if (batch.length === 0) {
      hasMore = false;
    } else {
      await processBatch(batch);
      offset += batchSize;
    }
  }
}</code></pre>

                <h3>4. Êé•Á∂ö„Éó„Éº„É´„ÅÆÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-javascript">// MongoDBÊé•Á∂ö„Éó„Éº„É´„ÅÆË®≠ÂÆö
mongoose.connect(uri, {
  maxPoolSize: 10, // ÊúÄÂ§ßÊé•Á∂öÊï∞
  minPoolSize: 2,  // ÊúÄÂ∞èÊé•Á∂öÊï∞
  serverSelectionTimeoutMS: 5000,
  socketTimeoutMS: 45000,
});

// PostgreSQLÊé•Á∂ö„Éó„Éº„É´„ÅÆË®≠ÂÆö
const sequelize = new Sequelize({
  // ... other config
  pool: {
    max: 20,           // ÊúÄÂ§ßÊé•Á∂öÊï∞
    min: 5,            // ÊúÄÂ∞èÊé•Á∂öÊï∞
    acquire: 30000,    // Êé•Á∂öÂèñÂæó„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà
    idle: 10000,       // „Ç¢„Ç§„Éâ„É´Êé•Á∂ö„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà
    evict: 1000,       // „Ç¢„Ç§„Éâ„É´Êé•Á∂ö„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÈñìÈöî
    validate: (client) => {
      // Êé•Á∂ö„ÅÆÊúâÂäπÊÄß„Çí„ÉÅ„Çß„ÉÉ„ÇØ
      return client.query('SELECT 1').then(() => true).catch(() => false);
    }
  }
});

// Êé•Á∂ö„Éó„Éº„É´„ÅÆÁõ£Ë¶ñ
sequelize.connectionManager.pool.on('acquire', () => {
  console.log('Connection acquired');
});

sequelize.connectionManager.pool.on('release', () => {
  console.log('Connection released');
});</code></pre>

                <h3>5. „ÇØ„Ç®„É™„Éì„É´„ÉÄ„Éº„Éë„Çø„Éº„É≥</h3>
                <pre><code class="language-javascript">// ÊüîËªü„Å™„ÇØ„Ç®„É™„Éì„É´„ÉÄ„Éº
class QueryBuilder {
  constructor(model) {
    this.model = model;
    this.query = {};
    this.options = {
      limit: 20,
      offset: 0,
      order: [['createdAt', 'DESC']]
    };
  }
  
  where(conditions) {
    Object.assign(this.query, conditions);
    return this;
  }
  
  whereIn(field, values) {
    this.query[field] = { [Op.in]: values };
    return this;
  }
  
  whereBetween(field, min, max) {
    this.query[field] = { [Op.between]: [min, max] };
    return this;
  }
  
  whereText(fields, searchTerm) {
    this.query[Op.or] = fields.map(field => ({
      [field]: { [Op.iLike]: `%${searchTerm}%` }
    }));
    return this;
  }
  
  include(association) {
    if (!this.options.include) {
      this.options.include = [];
    }
    this.options.include.push(association);
    return this;
  }
  
  orderBy(field, direction = 'ASC') {
    this.options.order = [[field, direction]];
    return this;
  }
  
  limit(limit) {
    this.options.limit = limit;
    return this;
  }
  
  offset(offset) {
    this.options.offset = offset;
    return this;
  }
  
  paginate(page, perPage = 20) {
    this.options.limit = perPage;
    this.options.offset = (page - 1) * perPage;
    return this;
  }
  
  async execute() {
    const results = await this.model.findAndCountAll({
      where: this.query,
      ...this.options
    });
    
    return {
      data: results.rows,
      total: results.count,
      page: Math.floor(this.options.offset / this.options.limit) + 1,
      pages: Math.ceil(results.count / this.options.limit)
    };
  }
}

// ‰ΩøÁî®‰æã
const results = await new QueryBuilder(Product)
  .where({ status: 'active' })
  .whereBetween('price', 100, 1000)
  .whereText(['name', 'description'], 'laptop')
  .include({
    model: Category,
    as: 'category'
  })
  .orderBy('price', 'DESC')
  .paginate(1, 20)
  .execute();</code></pre>
            </section>

            <!-- Database Design -->
            <section id="database-design" class="tutorial-section">
                <h2>„Éá„Éº„Çø„Éô„Éº„ÇπË®≠Ë®à</h2>
                <p>ÂäπÁéáÁöÑ„ÅßÊã°ÂºµÂèØËÉΩ„Å™„Éá„Éº„Çø„Éô„Éº„ÇπË®≠Ë®à„ÅÆÂéüÂâá„Å®„Éë„Çø„Éº„É≥„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>

                <h3>1. Ê≠£Ë¶èÂåñ„Å®ÈùûÊ≠£Ë¶èÂåñ</h3>
                <pre><code class="language-javascript">// Ê≠£Ë¶èÂåñ„Åï„Çå„Åü„Çπ„Ç≠„Éº„ÉûÔºà„É™„É¨„Éº„Ç∑„Éß„Éä„É´Ôºâ
// Á¨¨3Ê≠£Ë¶èÂΩ¢„Åæ„ÅßÊ≠£Ë¶èÂåñ
const User = sequelize.define('User', {
  id: { type: DataTypes.UUID, primaryKey: true },
  email: { type: DataTypes.STRING, unique: true },
  username: { type: DataTypes.STRING, unique: true }
});

const UserProfile = sequelize.define('UserProfile', {
  userId: { type: DataTypes.UUID, references: { model: User } },
  firstName: DataTypes.STRING,
  lastName: DataTypes.STRING,
  bio: DataTypes.TEXT,
  avatar: DataTypes.STRING
});

const Address = sequelize.define('Address', {
  id: { type: DataTypes.UUID, primaryKey: true },
  userId: { type: DataTypes.UUID, references: { model: User } },
  type: DataTypes.ENUM('home', 'work', 'other'),
  street: DataTypes.STRING,
  city: DataTypes.STRING,
  state: DataTypes.STRING,
  country: DataTypes.STRING,
  zipCode: DataTypes.STRING
});

// ÈùûÊ≠£Ë¶èÂåñ„Åï„Çå„Åü„Çπ„Ç≠„Éº„ÉûÔºàNoSQLÔºâ
// „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇíÂÑ™ÂÖà„Åó„Å¶‰∏ÄÈÉ®„ÅÆ„Éá„Éº„Çø„ÇíÂüã„ÇÅËæº„Åø
const userSchema = new Schema({
  email: String,
  username: String,
  profile: {
    firstName: String,
    lastName: String,
    bio: String,
    avatar: String
  },
  addresses: [{
    type: { type: String, enum: ['home', 'work', 'other'] },
    street: String,
    city: String,
    state: String,
    country: String,
    zipCode: String
  }],
  // È†ªÁπÅ„Å´„Ç¢„ÇØ„Çª„Çπ„Åï„Çå„ÇãÈõÜË®à„Éá„Éº„Çø„Çí‰øùÂ≠ò
  stats: {
    postCount: { type: Number, default: 0 },
    followerCount: { type: Number, default: 0 },
    followingCount: { type: Number, default: 0 }
  }
});</code></pre>

                <h3>2. „Çπ„Ç≠„Éº„ÉûË®≠Ë®à„Éë„Çø„Éº„É≥</h3>
                <pre><code class="language-javascript">// 1. „Éù„É™„É¢„Éº„Éï„Ç£„ÉÉ„ÇØÈñ¢ÈÄ£
const Comment = sequelize.define('Comment', {
  id: { type: DataTypes.UUID, primaryKey: true },
  content: DataTypes.TEXT,
  commentableId: DataTypes.UUID,
  commentableType: DataTypes.STRING, // 'Post', 'Product', 'User'
  userId: DataTypes.UUID
});

// ‰ΩøÁî®‰æã
Comment.belongsTo(Post, {
  foreignKey: 'commentableId',
  constraints: false,
  as: 'post'
});

Comment.belongsTo(Product, {
  foreignKey: 'commentableId',
  constraints: false,
  as: 'product'
});

// 2. ÈöéÂ±§„Éá„Éº„ÇøÔºà„ÉÑ„É™„ÉºÊßãÈÄ†Ôºâ
const Category = sequelize.define('Category', {
  id: { type: DataTypes.UUID, primaryKey: true },
  name: DataTypes.STRING,
  parentId: {
    type: DataTypes.UUID,
    references: { model: 'categories', key: 'id' }
  },
  path: DataTypes.STRING, // '/electronics/computers/laptops'
  depth: DataTypes.INTEGER
});

// Materialized Path Pattern
Category.beforeCreate((category) => {
  if (category.parentId) {
    const parent = await Category.findByPk(category.parentId);
    category.path = `${parent.path}/${category.name}`;
    category.depth = parent.depth + 1;
  } else {
    category.path = `/${category.name}`;
    category.depth = 0;
  }
});

// 3. „Çø„Ç∞„Ç∑„Çπ„ÉÜ„É†ÔºàÂ§öÂØæÂ§öÔºâ
const Tag = sequelize.define('Tag', {
  id: { type: DataTypes.UUID, primaryKey: true },
  name: { type: DataTypes.STRING, unique: true },
  slug: { type: DataTypes.STRING, unique: true }
});

const PostTag = sequelize.define('PostTag', {
  postId: DataTypes.UUID,
  tagId: DataTypes.UUID,
  order: DataTypes.INTEGER
});

Post.belongsToMany(Tag, { through: PostTag });
Tag.belongsToMany(Post, { through: PostTag });

// 4. „Ç§„Éô„É≥„Éà„ÇΩ„Éº„Ç∑„É≥„Ç∞
const Event = sequelize.define('Event', {
  id: { type: DataTypes.UUID, primaryKey: true },
  aggregateId: DataTypes.UUID,
  aggregateType: DataTypes.STRING,
  eventType: DataTypes.STRING,
  eventData: DataTypes.JSONB,
  userId: DataTypes.UUID,
  version: DataTypes.INTEGER,
  timestamp: DataTypes.DATE
}, {
  timestamps: false,
  indexes: [
    { fields: ['aggregateId', 'version'] },
    { fields: ['eventType'] },
    { fields: ['timestamp'] }
  ]
});</code></pre>

                <h3>3. ÊôÇÁ≥ªÂàó„Éá„Éº„Çø„ÅÆË®≠Ë®à</h3>
                <pre><code class="language-javascript">// ÊôÇÁ≥ªÂàó„Éá„Éº„ÇøÁî®„ÅÆ„Çπ„Ç≠„Éº„Éû
const Metric = sequelize.define('Metric', {
  id: { type: DataTypes.BIGINT, autoIncrement: true, primaryKey: true },
  deviceId: DataTypes.STRING,
  metricType: DataTypes.STRING,
  value: DataTypes.FLOAT,
  timestamp: DataTypes.DATE,
  metadata: DataTypes.JSONB
}, {
  tableName: 'metrics',
  timestamps: false,
  indexes: [
    {
      fields: ['deviceId', 'timestamp']
    },
    {
      fields: ['metricType', 'timestamp']
    }
  ]
});

// „Éë„Éº„ÉÜ„Ç£„Ç∑„Éß„Éã„É≥„Ç∞ÔºàPostgreSQLÔºâ
await sequelize.query(`
  CREATE TABLE metrics_2024_01 PARTITION OF metrics
  FOR VALUES FROM ('2024-01-01') TO ('2024-02-01');
`);

// ÈõÜË®àÁî®„ÅÆ„Éû„ÉÜ„É™„Ç¢„É©„Ç§„Ç∫„Éâ„Éì„É•„Éº
await sequelize.query(`
  CREATE MATERIALIZED VIEW hourly_metrics AS
  SELECT 
    deviceId,
    metricType,
    DATE_TRUNC('hour', timestamp) as hour,
    AVG(value) as avg_value,
    MIN(value) as min_value,
    MAX(value) as max_value,
    COUNT(*) as count
  FROM metrics
  GROUP BY deviceId, metricType, DATE_TRUNC('hour', timestamp);
  
  CREATE INDEX ON hourly_metrics (deviceId, hour);
`);</code></pre>

                <h3>4. „Éû„É´„ÉÅ„ÉÜ„Éä„É≥„Ç∑„Éº</h3>
                <pre><code class="language-javascript">// „Çπ„Ç≠„Éº„Éû„É¨„Éô„É´„ÅÆÂàÜÈõ¢
class TenantConnection {
  constructor() {
    this.connections = new Map();
  }
  
  async getConnection(tenantId) {
    if (!this.connections.has(tenantId)) {
      const config = {
        ...baseConfig,
        database: `tenant_${tenantId}`
      };
      
      const connection = new Sequelize(config);
      await connection.authenticate();
      
      this.connections.set(tenantId, connection);
    }
    
    return this.connections.get(tenantId);
  }
}

// Ë°å„É¨„Éô„É´„ÅÆÂàÜÈõ¢
const BaseModel = sequelize.define('BaseModel', {
  tenantId: {
    type: DataTypes.UUID,
    allowNull: false
  }
}, {
  hooks: {
    beforeFind: (options) => {
      // Ëá™ÂãïÁöÑ„Å´tenantId„Éï„Ç£„É´„Çø„Éº„ÇíËøΩÂä†
      if (options.where && !options.where.tenantId) {
        options.where.tenantId = getCurrentTenantId();
      }
    }
  }
});

// „Çπ„Ç≥„Éº„Éó„Çí‰Ωø„Å£„ÅüÂÆüË£Ö
Product.addScope('tenant', (tenantId) => ({
  where: { tenantId }
}));

// ‰ΩøÁî®
const products = await Product.scope({ method: ['tenant', tenantId] }).findAll();</code></pre>
            </section>

            <!-- Migrations -->
            <section id="migrations" class="tutorial-section">
                <h2>„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥</h2>
                <p>„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆ„Çπ„Ç≠„Éº„ÉûÂ§âÊõ¥„ÇíÂÆâÂÖ®„Å´ÁÆ°ÁêÜ„Åô„ÇãÊñπÊ≥ï„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>

                <h3>1. „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅÆÂü∫Êú¨</h3>
                <pre><code class="language-bash"># Sequelize„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅÆ‰ΩúÊàê
npx sequelize-cli migration:generate --name add-user-table

# „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅÆÂÆüË°å
npx sequelize-cli db:migrate

# „Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„ÅÆ„É≠„Éº„É´„Éê„ÉÉ„ÇØ
npx sequelize-cli db:migrate:undo

# ÁâπÂÆö„ÅÆ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥„Åæ„Åß„É≠„Éº„É´„Éê„ÉÉ„ÇØ
npx sequelize-cli db:migrate:undo:all --to 20240101000000-create-user.js</code></pre>

                <h3>2. ÂÆâÂÖ®„Å™„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥Êà¶Áï•</h3>
                <pre><code class="language-javascript">// „Ç´„É©„É†„ÅÆËøΩÂä†ÔºàÂÆâÂÖ®Ôºâ
module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.addColumn('users', 'phoneNumber', {
      type: Sequelize.STRING,
      allowNull: true, // ÊúÄÂàù„ÅØNULLË®±ÂèØ
      defaultValue: null
    });
  },
  
  down: async (queryInterface, Sequelize) => {
    await queryInterface.removeColumn('users', 'phoneNumber');
  }
};

// „Ç´„É©„É†„ÅÆÂâäÈô§ÔºàÊÆµÈöéÁöÑ„Å´ÂÆüË°åÔºâ
// Step 1: „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Ç≥„Éº„Éâ„Åã„Çâ‰ΩøÁî®„ÇíÂâäÈô§
// Step 2: „Ç´„É©„É†„ÇíNULLË®±ÂèØ„Å´Â§âÊõ¥
module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.changeColumn('users', 'oldColumn', {
      type: Sequelize.STRING,
      allowNull: true
    });
  }
};

// Step 3: ÂÆüÈöõ„Å´„Ç´„É©„É†„ÇíÂâäÈô§
module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.removeColumn('users', 'oldColumn');
  }
};

// „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆËøΩÂä†ÔºàCONCURRENTLY„Çí‰ΩøÁî®Ôºâ
module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.sequelize.query(
      'CREATE INDEX CONCURRENTLY idx_users_email ON users(email);'
    );
  },
  
  down: async (queryInterface, Sequelize) => {
    await queryInterface.sequelize.query(
      'DROP INDEX CONCURRENTLY idx_users_email;'
    );
  }
};</code></pre>

                <h3>3. „Éá„Éº„Çø„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥</h3>
                <pre><code class="language-javascript">// „Éá„Éº„Çø„ÅÆÂ§âÊèõ„Çí‰º¥„ÅÜ„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥
module.exports = {
  up: async (queryInterface, Sequelize) => {
    // Êñ∞„Åó„ÅÑ„Ç´„É©„É†„ÇíËøΩÂä†
    await queryInterface.addColumn('users', 'fullName', {
      type: Sequelize.STRING
    });
    
    // „Éê„ÉÉ„ÉÅ„Åß„Éá„Éº„Çø„ÇíÊõ¥Êñ∞
    const batchSize = 1000;
    let offset = 0;
    
    while (true) {
      const users = await queryInterface.sequelize.query(
        `SELECT id, "firstName", "lastName" FROM users 
         LIMIT :limit OFFSET :offset`,
        {
          replacements: { limit: batchSize, offset },
          type: Sequelize.QueryTypes.SELECT
        }
      );
      
      if (users.length === 0) break;
      
      // „Éê„É´„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Éà
      const updates = users.map(user => ({
        id: user.id,
        fullName: `${user.firstName} ${user.lastName}`
      }));
      
      await queryInterface.bulkUpdate('users', updates);
      
      offset += batchSize;
      console.log(`Updated ${offset} users...`);
    }
  },
  
  down: async (queryInterface, Sequelize) => {
    await queryInterface.removeColumn('users', 'fullName');
  }
};</code></pre>

                <h3>4. MongoDB„Éû„Ç§„Ç∞„É¨„Éº„Ç∑„Éß„É≥</h3>
                <pre><code class="language-javascript">// migrate-mongo „ÅÆ‰ΩøÁî®
const migration = {
  async up(db, client) {
    // „Ç≥„É¨„ÇØ„Ç∑„Éß„É≥„ÅÆ‰ΩúÊàê
    await db.createCollection('products');
    
    // „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆ‰ΩúÊàê
    await db.collection('products').createIndex({ sku: 1 }, { unique: true });
    await db.collection('products').createIndex({ name: 'text', description: 'text' });
    
    // Êó¢Â≠ò„Éá„Éº„Çø„ÅÆÊõ¥Êñ∞
    await db.collection('users').updateMany(
      { role: { $exists: false } },
      { $set: { role: 'customer' } }
    );
    
    // „Éï„Ç£„Éº„É´„Éâ„ÅÆ„É™„Éç„Éº„É†
    await db.collection('orders').updateMany(
      {},
      { $rename: { 'total': 'totalAmount' } }
    );
  },
  
  async down(db, client) {
    await db.collection('products').drop();
    await db.collection('orders').updateMany(
      {},
      { $rename: { 'totalAmount': 'total' } }
    );
  }
};

module.exports = migration;</code></pre>
            </section>

            <!-- Backup and Replication -->
            <section id="backup-replication" class="tutorial-section">
                <h2>„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Å®„É¨„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥</h2>
                <p>„Éá„Éº„Çø„ÅÆÂÆâÂÖ®ÊÄß„ÇíÁ¢∫‰øù„Åô„Çã„Åü„ÇÅ„ÅÆ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÊà¶Áï•„Å®„É¨„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆöÊñπÊ≥ï„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>

                <h3>1. PostgreSQL„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó</h3>
                <pre><code class="language-bash"># Ë´ñÁêÜ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÔºàpg_dumpÔºâ
pg_dump -h localhost -U postgres -d myapp > backup.sql

# „Ç´„Çπ„Çø„É†„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Åß„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÔºàÂúßÁ∏ÆÔºâ
pg_dump -h localhost -U postgres -d myapp -Fc > backup.dump

# ÁâπÂÆö„ÅÆ„ÉÜ„Éº„Éñ„É´„ÅÆ„Åø„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
pg_dump -h localhost -U postgres -d myapp -t users -t orders > tables_backup.sql

# „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„ÅÆ„É™„Çπ„Éà„Ç¢
psql -h localhost -U postgres -d myapp_restore < backup.sql

# „Ç´„Çπ„Çø„É†„Éï„Ç©„Éº„Éû„ÉÉ„Éà„ÅÆ„É™„Çπ„Éà„Ç¢
pg_restore -h localhost -U postgres -d myapp_restore backup.dump</code></pre>

                <h3>2. MongoDB„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó</h3>
                <pre><code class="language-bash"># mongodump„Çí‰ΩøÁî®„Åó„Åü„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
mongodump --host localhost --port 27017 --db myapp --out /backup/mongo/

# ÁâπÂÆö„ÅÆ„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥„ÅÆ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
mongodump --host localhost --port 27017 --db myapp --collection users

# ÂúßÁ∏Æ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
mongodump --archive=myapp.archive --gzip --db myapp

# „É™„Çπ„Éà„Ç¢
mongorestore --host localhost --port 27017 /backup/mongo/myapp/

# „Ç¢„Éº„Ç´„Ç§„Éñ„Åã„Çâ„ÅÆ„É™„Çπ„Éà„Ç¢
mongorestore --archive=myapp.archive --gzip</code></pre>

                <h3>3. Ëá™Âãï„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Çπ„ÇØ„É™„Éó„Éà</h3>
                <p><strong>scripts/backup.js</strong></p>
                <pre><code class="language-javascript">const { spawn } = require('child_process');
const fs = require('fs').promises;
const path = require('path');
const AWS = require('aws-sdk');

const s3 = new AWS.S3();

class BackupManager {
  constructor(config) {
    this.config = config;
    this.backupDir = config.backupDir || '/tmp/backups';
  }
  
  async backupPostgres() {
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    const filename = `postgres-backup-${timestamp}.dump`;
    const filepath = path.join(this.backupDir, filename);
    
    // „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆ‰ΩúÊàê
    await fs.mkdir(this.backupDir, { recursive: true });
    
    // pg_dump„ÅÆÂÆüË°å
    return new Promise((resolve, reject) => {
      const pgDump = spawn('pg_dump', [
        '-h', this.config.postgres.host,
        '-U', this.config.postgres.user,
        '-d', this.config.postgres.database,
        '-Fc',
        '-f', filepath
      ], {
        env: {
          ...process.env,
          PGPASSWORD: this.config.postgres.password
        }
      });
      
      pgDump.on('exit', (code) => {
        if (code === 0) {
          resolve(filepath);
        } else {
          reject(new Error(`pg_dump exited with code ${code}`));
        }
      });
    });
  }
  
  async backupMongoDB() {
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    const filename = `mongodb-backup-${timestamp}.archive`;
    const filepath = path.join(this.backupDir, filename);
    
    return new Promise((resolve, reject) => {
      const mongoDump = spawn('mongodump', [
        '--uri', this.config.mongodb.uri,
        '--archive=' + filepath,
        '--gzip'
      ]);
      
      mongoDump.on('exit', (code) => {
        if (code === 0) {
          resolve(filepath);
        } else {
          reject(new Error(`mongodump exited with code ${code}`));
        }
      });
    });
  }
  
  async uploadToS3(filepath) {
    const fileStream = await fs.readFile(filepath);
    const filename = path.basename(filepath);
    
    const params = {
      Bucket: this.config.s3.bucket,
      Key: `backups/${filename}`,
      Body: fileStream,
      ServerSideEncryption: 'AES256'
    };
    
    const result = await s3.upload(params).promise();
    console.log(`Uploaded to S3: ${result.Location}`);
    
    // „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´„ÇíÂâäÈô§
    await fs.unlink(filepath);
    
    return result.Location;
  }
  
  async runBackup() {
    try {
      console.log('Starting backup process...');
      
      // PostgreSQL„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
      if (this.config.postgres) {
        const pgFile = await this.backupPostgres();
        await this.uploadToS3(pgFile);
        console.log('PostgreSQL backup completed');
      }
      
      // MongoDB„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó
      if (this.config.mongodb) {
        const mongoFile = await this.backupMongoDB();
        await this.uploadToS3(mongoFile);
        console.log('MongoDB backup completed');
      }
      
      // Âè§„ÅÑ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„ÅÆÂâäÈô§
      await this.cleanupOldBackups();
      
      console.log('Backup process completed successfully');
    } catch (error) {
      console.error('Backup failed:', error);
      // ÈÄöÁü•„ÇíÈÄÅ‰ø°
      await this.sendNotification('Backup failed', error.message);
    }
  }
  
  async cleanupOldBackups() {
    const retentionDays = this.config.retentionDays || 30;
    const cutoffDate = new Date();
    cutoffDate.setDate(cutoffDate.getDate() - retentionDays);
    
    const params = {
      Bucket: this.config.s3.bucket,
      Prefix: 'backups/'
    };
    
    const objects = await s3.listObjectsV2(params).promise();
    
    const toDelete = objects.Contents
      .filter(obj => new Date(obj.LastModified) < cutoffDate)
      .map(obj => ({ Key: obj.Key }));
    
    if (toDelete.length > 0) {
      await s3.deleteObjects({
        Bucket: this.config.s3.bucket,
        Delete: { Objects: toDelete }
      }).promise();
      
      console.log(`Deleted ${toDelete.length} old backups`);
    }
  }
}

// Cron„Ç∏„Éß„Éñ„Å®„Åó„Å¶ÂÆüË°å
const cron = require('node-cron');
const backupManager = new BackupManager(require('./backup-config'));

// ÊØéÊó•ÂçàÂâç2ÊôÇ„Å´ÂÆüË°å
cron.schedule('0 2 * * *', async () => {
  await backupManager.runBackup();
});</code></pre>

                <h3>4. „É¨„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ë®≠ÂÆö</h3>
                <p><strong>MongoDB „É¨„Éó„É™„Ç´„Çª„ÉÉ„Éà</strong></p>
                <pre><code class="language-javascript">// „É¨„Éó„É™„Ç´„Çª„ÉÉ„ÉàÊé•Á∂ö
mongoose.connect('mongodb://localhost:27017,localhost:27018,localhost:27019/myapp', {
  replicaSet: 'rs0',
  readPreference: 'secondaryPreferred', // Ë™≠„ÅøÂèñ„ÇäË≤†Ëç∑„ÇíÂàÜÊï£
  w: 'majority', // Êõ∏„ÅçËæº„ÅøÁ¢∫Ë™ç
  j: true, // „Ç∏„É£„Éº„Éä„É´Êõ∏„ÅçËæº„Åø
  wtimeout: 5000
});

// Ë™≠„ÅøÂèñ„ÇäË®≠ÂÆö„ÅÆÂà∂Âæ°
const User = mongoose.model('User', userSchema);

// „Éó„É©„Ç§„Éû„É™„Åã„ÇâË™≠„ÅøÂèñ„ÇäÔºàÊúÄÊñ∞„Éá„Éº„Çø„ÅåÂøÖË¶Å„Å™Â†¥ÂêàÔºâ
const user = await User.findById(userId).read('primary');

// „Çª„Ç´„É≥„ÉÄ„É™„Åã„ÇâË™≠„ÅøÂèñ„ÇäÔºàË≤†Ëç∑ÂàÜÊï£Ôºâ
const users = await User.find({}).read('secondary');

// ÊúÄÂØÑ„Çä„ÅÆ„Éé„Éº„Éâ„Åã„ÇâË™≠„ÅøÂèñ„Çä
const products = await Product.find({}).read('nearest');</code></pre>

                <p><strong>PostgreSQL „Çπ„Éà„É™„Éº„Éü„É≥„Ç∞„É¨„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥</strong></p>
                <pre><code class="language-bash"># „Éó„É©„Ç§„Éû„É™„Çµ„Éº„Éê„Éº„ÅÆË®≠ÂÆöÔºàpostgresql.confÔºâ
wal_level = replica
max_wal_senders = 3
wal_keep_segments = 64
archive_mode = on
archive_command = 'cp %p /var/lib/postgresql/archive/%f'

# „Çπ„Çø„É≥„Éê„Ç§„Çµ„Éº„Éê„Éº„ÅÆË®≠ÂÆö
# 1. „Éô„Éº„Çπ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„ÅÆÂèñÂæó
pg_basebackup -h primary_host -D /var/lib/postgresql/data -U replicator -P -W

# 2. recovery.conf „ÅÆ‰ΩúÊàê
standby_mode = 'on'
primary_conninfo = 'host=primary_host port=5432 user=replicator'
trigger_file = '/tmp/postgresql.trigger'</code></pre>

                <h3>5. ÁÅΩÂÆ≥Âæ©ÊóßË®àÁîª</h3>
                <pre><code class="language-javascript">// Âæ©ÊóßÊâãÈ†Ü„ÅÆËá™ÂãïÂåñ
class DisasterRecovery {
  async performHealthCheck() {
    const checks = {
      postgres: await this.checkPostgres(),
      mongodb: await this.checkMongoDB(),
      redis: await this.checkRedis()
    };
    
    return checks;
  }
  
  async checkPostgres() {
    try {
      await sequelize.authenticate();
      const [result] = await sequelize.query('SELECT 1');
      return { status: 'healthy', latency: result.time };
    } catch (error) {
      return { status: 'unhealthy', error: error.message };
    }
  }
  
  async initiateFailover() {
    console.log('Initiating failover process...');
    
    // 1. „Éó„É©„Ç§„Éû„É™„ÅÆÂÅúÊ≠¢„ÇíÁ¢∫Ë™ç
    const primaryHealth = await this.checkPrimary();
    if (primaryHealth.status === 'healthy') {
      throw new Error('Primary is still healthy, aborting failover');
    }
    
    // 2. „Çπ„Çø„É≥„Éê„Ç§„Çí„Éó„É©„Ç§„Éû„É™„Å´ÊòáÊ†º
    await this.promoteStandby();
    
    // 3. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÊé•Á∂öÂÖà„ÇíÊõ¥Êñ∞
    await this.updateConnectionStrings();
    
    // 4. ÈÄöÁü•„ÇíÈÄÅ‰ø°
    await this.notifyTeam('Failover completed', {
      oldPrimary: this.config.primary,
      newPrimary: this.config.standby
    });
  }
  
  async performBackupRestore(backupId) {
    // 1. „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
    const backupPath = await this.downloadBackup(backupId);
    
    // 2. „Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÂæ©ÂÖÉ
    await this.restoreDatabase(backupPath);
    
    // 3. Êï¥ÂêàÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
    await this.verifyDataIntegrity();
    
    // 4. „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂÜçËµ∑Âãï
    await this.restartApplication();
  }
}</code></pre>
            </section>

            <!-- Performance Tuning -->
            <section id="performance-tuning" class="tutorial-section">
                <h2>„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÅ„É•„Éº„Éã„É≥„Ç∞</h2>
                <p>„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇíÊúÄÂ§ßÂåñ„Åô„Çã„Åü„ÇÅ„ÅÆÂÆüË∑µÁöÑ„Å™„ÉÜ„ÇØ„Éã„ÉÉ„ÇØ„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>

                <h3>1. „ÇØ„Ç®„É™„ÅÆÂàÜÊûê„Å®ÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-javascript">// PostgreSQL EXPLAINÂàÜÊûê
const analyzeQuery = async (query) => {
  const result = await sequelize.query(
    `EXPLAIN (ANALYZE, BUFFERS) ${query}`,
    { type: sequelize.QueryTypes.SELECT }
  );
  
  console.log('Query Plan:', result);
};

// „Çπ„É≠„Éº„ÇØ„Ç®„É™„É≠„Ç∞„ÅÆÊúâÂäπÂåñ
sequelize.options.logging = (sql, timing) => {
  if (timing > 1000) { // 1Áßí‰ª•‰∏ä„Åã„Åã„Çã„ÇØ„Ç®„É™
    console.warn('Slow query detected:', {
      sql,
      duration: timing,
      timestamp: new Date()
    });
    
    // „Çπ„É≠„Éº„ÇØ„Ç®„É™„ÇíRedis„Å´Ë®òÈå≤
    redis.zadd('slow_queries', Date.now(), JSON.stringify({
      sql,
      duration: timing,
      timestamp: new Date()
    }));
  }
};

// MongoDB „Éó„É≠„Éï„Ç°„Ç§„É™„É≥„Ç∞
db.setProfilingLevel(1, { slowms: 100 }); // 100ms‰ª•‰∏ä„ÅÆ„ÇØ„Ç®„É™„ÇíË®òÈå≤

// „Éó„É≠„Éï„Ç°„Ç§„É´ÁµêÊûú„ÅÆÂàÜÊûê
const slowQueries = await db.collection('system.profile')
  .find({ millis: { $gt: 100 } })
  .sort({ ts: -1 })
  .limit(10)
  .toArray();</code></pre>

                <h3>2. „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-javascript">// „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ‰ΩøÁî®Áä∂Ê≥Å„ÅÆÂàÜÊûê
async function analyzeIndexUsage() {
  // PostgreSQL
  const pgIndexStats = await sequelize.query(`
    SELECT 
      schemaname,
      tablename,
      indexname,
      idx_scan,
      idx_tup_read,
      idx_tup_fetch,
      pg_size_pretty(pg_relation_size(indexrelid)) as index_size
    FROM pg_stat_user_indexes
    WHERE idx_scan = 0
    ORDER BY pg_relation_size(indexrelid) DESC;
  `, { type: sequelize.QueryTypes.SELECT });
  
  console.log('Unused indexes:', pgIndexStats);
  
  // MongoDB
  const collections = await db.listCollections().toArray();
  
  for (const collection of collections) {
    const stats = await db.collection(collection.name).aggregate([
      { $indexStats: {} }
    ]).toArray();
    
    const unusedIndexes = stats.filter(idx => 
      idx.accesses.ops === 0 && idx.name !== '_id_'
    );
    
    if (unusedIndexes.length > 0) {
      console.log(`Unused indexes in ${collection.name}:`, unusedIndexes);
    }
  }
}

// Ë§áÂêà„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆÊúÄÈÅ©Âåñ
// „Ç´„Éº„Éá„Ç£„Éä„É™„ÉÜ„Ç£„ÅÆÈ´ò„ÅÑÈ†Ü„Å´‰∏¶„Åπ„Çã
userSchema.index({ status: 1, createdAt: -1, userId: 1 }); // ÊÇ™„ÅÑ‰æã
userSchema.index({ userId: 1, createdAt: -1, status: 1 }); // ËâØ„ÅÑ‰æã

// ÈÉ®ÂàÜ„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÔºàÊù°‰ª∂‰ªò„Åç„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÔºâ
await sequelize.query(`
  CREATE INDEX idx_active_products 
  ON products(name, price) 
  WHERE status = 'active';
`);</code></pre>

                <h3>3. Êé•Á∂ö„Éó„Éº„É´„Å®„É™„ÇΩ„Éº„ÇπÁÆ°ÁêÜ</h3>
                <pre><code class="language-javascript">// Êé•Á∂ö„Éó„Éº„É´„ÅÆÁõ£Ë¶ñ„Å®Ë™øÊï¥
class ConnectionPoolMonitor {
  constructor(sequelize, redis) {
    this.sequelize = sequelize;
    this.redis = redis;
    this.metrics = {
      acquired: 0,
      released: 0,
      pending: 0,
      failed: 0
    };
  }
  
  start() {
    const pool = this.sequelize.connectionManager.pool;
    
    pool.on('acquire', () => {
      this.metrics.acquired++;
      this.metrics.pending = pool.pending;
      this.logMetrics();
    });
    
    pool.on('release', () => {
      this.metrics.released++;
      this.logMetrics();
    });
    
    pool.on('error', () => {
      this.metrics.failed++;
      this.logMetrics();
    });
    
    // ÂÆöÊúüÁöÑ„Å´„É°„Éà„É™„ÇØ„Çπ„ÇíË®òÈå≤
    setInterval(() => {
      this.saveMetrics();
    }, 60000); // 1ÂàÜ„Åî„Å®
  }
  
  logMetrics() {
    const pool = this.sequelize.connectionManager.pool;
    console.log('Connection Pool Stats:', {
      size: pool.size,
      available: pool.available,
      using: pool.using,
      pending: pool.pending,
      ...this.metrics
    });
  }
  
  async saveMetrics() {
    const timestamp = Date.now();
    const pool = this.sequelize.connectionManager.pool;
    
    await this.redis.zadd('pool_metrics', timestamp, JSON.stringify({
      timestamp,
      size: pool.size,
      available: pool.available,
      using: pool.using,
      pending: pool.pending,
      ...this.metrics
    }));
  }
  
  async getPoolRecommendations() {
    const recentMetrics = await this.redis.zrange(
      'pool_metrics', 
      -100, 
      -1
    );
    
    const parsed = recentMetrics.map(m => JSON.parse(m));
    const avgPending = parsed.reduce((sum, m) => sum + m.pending, 0) / parsed.length;
    const maxUsing = Math.max(...parsed.map(m => m.using));
    
    const recommendations = [];
    
    if (avgPending > 5) {
      recommendations.push('Êé•Á∂ö„Éó„Éº„É´„Çµ„Ç§„Ç∫„ÇíÂ¢ó„ÇÑ„Åô„Åì„Å®„ÇíÊ§úË®é„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
    }
    
    if (maxUsing < pool.max * 0.5) {
      recommendations.push('Êé•Á∂ö„Éó„Éº„É´„Çµ„Ç§„Ç∫„ÇíÊ∏õ„Çâ„Åô„Åì„Å®„Åå„Åß„Åç„Åæ„Åô');
    }
    
    return recommendations;
  }
}</code></pre>

                <h3>4. „Ç≠„É£„ÉÉ„Ç∑„É•Êà¶Áï•„ÅÆÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-javascript">// Â§öÂ±§„Ç≠„É£„ÉÉ„Ç∑„É•Êà¶Áï•
class MultiLayerCache {
  constructor(redis) {
    this.redis = redis;
    this.localCache = new Map();
    this.stats = {
      localHits: 0,
      redisHits: 0,
      misses: 0
    };
  }
  
  async get(key) {
    // L1: „É≠„Éº„Ç´„É´„É°„É¢„É™„Ç≠„É£„ÉÉ„Ç∑„É•
    if (this.localCache.has(key)) {
      this.stats.localHits++;
      return this.localCache.get(key).value;
    }
    
    // L2: Redis„Ç≠„É£„ÉÉ„Ç∑„É•
    const redisValue = await this.redis.get(key);
    if (redisValue) {
      this.stats.redisHits++;
      const parsed = JSON.parse(redisValue);
      
      // „É≠„Éº„Ç´„É´„Ç≠„É£„ÉÉ„Ç∑„É•„Å´‰øùÂ≠ò
      this.setLocal(key, parsed, 60); // 1ÂàÜÈñì
      
      return parsed;
    }
    
    this.stats.misses++;
    return null;
  }
  
  async set(key, value, ttl = 300) {
    // ‰∏°Êñπ„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„Å´‰øùÂ≠ò
    await this.redis.setex(key, ttl, JSON.stringify(value));
    this.setLocal(key, value, Math.min(ttl, 300)); // ÊúÄÂ§ß5ÂàÜ
  }
  
  setLocal(key, value, ttl) {
    this.localCache.set(key, {
      value,
      expires: Date.now() + (ttl * 1000)
    });
    
    // „É°„É¢„É™Âà∂ÈôêÔºà1000„Ç®„É≥„Éà„É™Ôºâ
    if (this.localCache.size > 1000) {
      const firstKey = this.localCache.keys().next().value;
      this.localCache.delete(firstKey);
    }
  }
  
  // ÊúüÈôêÂàá„Çå„Ç®„É≥„Éà„É™„ÅÆÂâäÈô§
  cleanup() {
    const now = Date.now();
    for (const [key, entry] of this.localCache.entries()) {
      if (entry.expires < now) {
        this.localCache.delete(key);
      }
    }
  }
  
  getStats() {
    const total = this.stats.localHits + this.stats.redisHits + this.stats.misses;
    return {
      ...this.stats,
      hitRate: total > 0 ? (this.stats.localHits + this.stats.redisHits) / total : 0,
      localHitRate: total > 0 ? this.stats.localHits / total : 0
    };
  }
}

// „Ç¶„Ç©„Éº„É†„Ç¢„ÉÉ„ÉóÊà¶Áï•
class CacheWarmer {
  constructor(cache, models) {
    this.cache = cache;
    this.models = models;
  }
  
  async warmupPopularData() {
    console.log('Starting cache warmup...');
    
    // ‰∫∫Ê∞óÂïÜÂìÅ„Çí„Ç≠„É£„ÉÉ„Ç∑„É•
    const popularProducts = await this.models.Product.findAll({
      where: { status: 'active' },
      order: [['views', 'DESC']],
      limit: 100
    });
    
    for (const product of popularProducts) {
      await this.cache.set(
        `product:${product.id}`,
        product.toJSON(),
        3600 // 1ÊôÇÈñì
      );
    }
    
    // „Ç´„ÉÜ„Ç¥„É™„Éº„Çí„Ç≠„É£„ÉÉ„Ç∑„É•
    const categories = await this.models.Category.findAll({
      include: [{
        model: this.models.Product,
        as: 'products',
        where: { status: 'active' },
        required: false,
        attributes: ['id']
      }]
    });
    
    for (const category of categories) {
      await this.cache.set(
        `category:${category.id}`,
        category.toJSON(),
        7200 // 2ÊôÇÈñì
      );
    }
    
    console.log('Cache warmup completed');
  }
}</code></pre>

                <h3>5. „Éá„Éº„Çø„Éô„Éº„ÇπË®≠ÂÆö„ÅÆÊúÄÈÅ©Âåñ</h3>
                <pre><code class="language-sql">-- PostgreSQL „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπË®≠ÂÆö
-- postgresql.conf

-- „É°„É¢„É™Ë®≠ÂÆö
shared_buffers = '4GB'              -- Á∑è„É°„É¢„É™„ÅÆ25%Á®ãÂ∫¶
effective_cache_size = '12GB'       -- Á∑è„É°„É¢„É™„ÅÆ75%Á®ãÂ∫¶
work_mem = '64MB'                   -- „ÇΩ„Éº„Éà/„Éè„ÉÉ„Ç∑„É•Êìç‰ΩúÁî®
maintenance_work_mem = '512MB'      -- VACUUM, CREATE INDEXÁî®

-- „ÉÅ„Çß„ÉÉ„ÇØ„Éù„Ç§„É≥„ÉàË®≠ÂÆö
checkpoint_timeout = '15min'
checkpoint_completion_target = 0.9
wal_buffers = '16MB'

-- ‰∏¶ÂàóÂá¶ÁêÜ
max_parallel_workers_per_gather = 4
max_parallel_workers = 8

-- Áµ±Ë®àÊÉÖÂ†±
default_statistics_target = 100
random_page_cost = 1.1              -- SSD„ÅÆÂ†¥Âêà</code></pre>

                <pre><code class="language-javascript">// MongoDB „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπË®≠ÂÆö
// mongod.conf
{
  "systemLog": {
    "destination": "file",
    "path": "/var/log/mongodb/mongod.log",
    "logAppend": true
  },
  "storage": {
    "dbPath": "/var/lib/mongodb",
    "journal": {
      "enabled": true
    },
    "wiredTiger": {
      "engineConfig": {
        "cacheSizeGB": 4,
        "journalCompressor": "snappy"
      },
      "collectionConfig": {
        "blockCompressor": "zstd"
      }
    }
  },
  "net": {
    "bindIp": "0.0.0.0",
    "maxIncomingConnections": 1000
  },
  "operationProfiling": {
    "mode": "slowOp",
    "slowOpThresholdMs": 100
  }
}</code></pre>
            </section>

            <!-- Best Practices -->
            <section id="best-practices" class="tutorial-section">
                <h2>„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ</h2>
                <p>„Éá„Éº„Çø„Éô„Éº„ÇπÈñãÁô∫„Å´„Åä„Åë„ÇãÈáçË¶Å„Å™ÂéüÂâá„Å®„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ„Çí„Åæ„Å®„ÇÅ„Åæ„Åô„ÄÇ</p>

                <div class="best-practices-grid">
                    <div class="practice-item">
                        <h3>1. „Çª„Ç≠„É•„É™„ÉÜ„Ç£</h3>
                        <ul>
                            <li>SQL„Ç§„É≥„Ç∏„Çß„ÇØ„Ç∑„Éß„É≥ÂØæÁ≠ñÔºà„Éë„É©„É°„Éº„ÇøÂåñ„ÇØ„Ç®„É™„ÅÆ‰ΩøÁî®Ôºâ</li>
                            <li>ÊúÄÂ∞èÊ®©Èôê„ÅÆÂéüÂâá„Å´Âæì„Å£„Åü„É¶„Éº„Ç∂„ÉºÊ®©ÈôêË®≠ÂÆö</li>
                            <li>Êé•Á∂ö„ÅÆÊöóÂè∑ÂåñÔºàSSL/TLSÔºâ</li>
                            <li>Ê©üÂØÜ„Éá„Éº„Çø„ÅÆÊöóÂè∑Âåñ</li>
                            <li>ÂÆöÊúüÁöÑ„Å™„Çª„Ç≠„É•„É™„ÉÜ„Ç£Áõ£Êüª</li>
                        </ul>
                    </div>
                    
                    <div class="practice-item">
                        <h3>2. „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</h3>
                        <ul>
                            <li>ÈÅ©Âàá„Å™„Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÅÆË®≠Ë®à„Å®ÁÆ°ÁêÜ</li>
                            <li>„ÇØ„Ç®„É™„ÅÆÊúÄÈÅ©Âåñ„Å®EXPLAINÂàÜÊûê</li>
                            <li>Êé•Á∂ö„Éó„Éº„É´„ÅÆÈÅ©Âàá„Å™Ë®≠ÂÆö</li>
                            <li>„Ç≠„É£„ÉÉ„Ç∑„É•Êà¶Áï•„ÅÆÂÆüË£Ö</li>
                            <li>ÂÆöÊúüÁöÑ„Å™„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁõ£Ë¶ñ</li>
                        </ul>
                    </div>
                    
                    <div class="practice-item">
                        <h3>3. ÂèØÁî®ÊÄß</h3>
                        <ul>
                            <li>„É¨„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆö</li>
                            <li>Ëá™Âãï„Éï„Çß„Ç§„É´„Ç™„Éº„Éê„Éº„ÅÆÂÆüË£Ö</li>
                            <li>ÂÆöÊúüÁöÑ„Å™„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Å®„ÉÜ„Çπ„Éà</li>
                            <li>ÁÅΩÂÆ≥Âæ©ÊóßË®àÁîª„ÅÆÁ≠ñÂÆö</li>
                            <li>„Éò„É´„Çπ„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂÆüË£Ö</li>
                        </ul>
                    </div>
                    
                    <div class="practice-item">
                        <h3>4. ‰øùÂÆàÊÄß</h3>
                        <ul>
                            <li>ÊòéÁ¢∫„Å™ÂëΩÂêçË¶èÂâá„ÅÆÊé°Áî®</li>
                            <li>„Çπ„Ç≠„Éº„Éû„ÅÆ„Éê„Éº„Ç∏„Éß„É≥ÁÆ°ÁêÜ</li>
                            <li>ÂåÖÊã¨ÁöÑ„Å™„Éâ„Ç≠„É•„É°„É≥„ÉÜ„Éº„Ç∑„Éß„É≥</li>
                            <li>„ÉÜ„Çπ„ÉàÁí∞Â¢É„ÅÆÊï¥ÂÇô</li>
                            <li>Áõ£Ë¶ñ„Å®„Ç¢„É©„Éº„Éà„ÅÆË®≠ÂÆö</li>
                        </ul>
                    </div>
                </div>

                <h3>„Åæ„Å®„ÇÅ</h3>
                <p>„Åì„ÅÆ„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´„Åß„ÅØ„ÄÅNode.js„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Å´„Åä„Åë„Çã‰∏ªË¶Å„Å™„Éá„Éº„Çø„Éô„Éº„ÇπÊäÄË°ìÔºàMongoDB„ÄÅPostgreSQL„ÄÅRedisÔºâ„ÅÆÂÆüË∑µÁöÑ„Å™‰ΩøÁî®ÊñπÊ≥ï„ÇíÂ≠¶„Å≥„Åæ„Åó„Åü„ÄÇÈÅ©Âàá„Å™„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆÈÅ∏Êäû„ÄÅÂäπÁéáÁöÑ„Å™Ë®≠Ë®à„ÄÅ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÅÆÊúÄÈÅ©Âåñ„ÄÅ„Åù„Åó„Å¶‰ø°È†ºÊÄß„ÅÆÈ´ò„ÅÑÈÅãÁî®ÊñπÊ≥ï„ÇíÁêÜËß£„Åô„Çã„Åì„Å®„Åß„ÄÅ„Çπ„Ç±„Éº„É©„Éñ„É´„ÅßÂ†ÖÁâ¢„Å™„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÊßãÁØâ„Åß„Åç„Çã„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ</p>
            </section>

            <!-- Navigation -->
            <div style="text-align: center; margin: 3rem 0;">
                <a href="express-generator-tutorial.html" class="btn btn-outline-primary">
                    <i class="fas fa-arrow-left"></i> Express Generator
                </a>
                <a href="index.html" class="btn btn-outline-primary">
                    <i class="fas fa-home"></i> „Éõ„Éº„É†„Å∏Êàª„Çã
                </a>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer style="background: #2c3e50; color: white; padding: 2rem 0; margin-top: 2rem;">
        <div class="container">
            <div style="text-align: center;">
                <div style="margin-bottom: 1rem;">
                    <a href="index.html" style="color: white; text-decoration: none; margin: 0 1rem;">„Éõ„Éº„É†</a>
                    <a href="nodejs-tutorial.html" style="color: white; text-decoration: none; margin: 0 1rem;">Node.jsÂü∫Á§é</a>
                    <a href="express-tutorial.html" style="color: white; text-decoration: none; margin: 0 1rem;">Express.js</a>
                    <a href="express-generator-tutorial.html" style="color: white; text-decoration: none; margin: 0 1rem;">Express Generator</a>
                    <a href="https://nodejs.org/" target="_blank" style="color: white; text-decoration: none; margin: 0 1rem;">Node.js ÂÖ¨Âºè</a>
                    <a href="https://expressjs.com/" target="_blank" style="color: white; text-decoration: none; margin: 0 1rem;">Express.js ÂÖ¨Âºè</a>
                </div>
                <p style="margin: 0;">&copy; 2024 Node.js Tutorial. „Åì„ÅÆ„ÉÅ„É•„Éº„Éà„É™„Ç¢„É´„ÅØÂ≠¶ÁøíÁõÆÁöÑ„Åß‰ΩúÊàê„Åï„Çå„Åæ„Åó„Åü„ÄÇ</p>
                <p style="margin: 0.5rem 0 0 0;">
                    <i class="fas fa-heart" style="color: #e74c3c;"></i> 
                    Made with Node.js and Express.js
                </p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" style="position: fixed; bottom: 20px; right: 20px; background: var(--primary-color); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; box-shadow: var(--shadow); display: none;" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script>
        // Initialize Prism for syntax highlighting
        document.addEventListener('DOMContentLoaded', function() {
            Prism.highlightAll();
            
            // Back to top button functionality
            const backToTopBtn = document.getElementById('backToTop');
            
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = 'block';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });
            
            // Mobile navigation toggle
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');
            
            if (navToggle && navMenu) {
                navToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                });
            }
        });
    </script>
</body>
</html>